(function(){"use strict";var e={4835:function(e,t,a){var s=a(5130),n=a(657),o=a(6768);const r={class:"game-layout",style:{border:"2px solid lightblue",position:"relative"}},i={class:"game-layout__content"};var l=(0,o.pM)({__name:"GameLayout",setup(e){return(e,t)=>((0,o.uX)(),(0,o.CE)("div",r,[t[0]||(t[0]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"GameLayout",-1)),(0,o.Lk)("main",i,[(0,o.RG)(e.$slots,"default")]),t[1]||(t[1]=(0,o.Lk)("footer",{class:"game-layout__footer"},[(0,o.Lk)("p",null,"© 2025 Pathfinder's Journey")],-1))]))}}),c=a(1241);const d=(0,c.A)(l,[["__scopeId","data-v-656b48d5"]]);var u=d,h=(0,o.pM)({__name:"App",setup(e){return(e,t)=>{const a=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.Wv)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(a)])),_:1})}}});const p=h;var m,g=p,f=a(1387),y=(a(4114),a(4232)),v=a(144);a(8111),a(2489),a(116),a(7588),a(1701),a(3579);(function(e){e["LOYAL"]="LOYAL",e["WARY"]="WARY",e["LEAVING"]="LEAVING"})(m||(m={}));var C,L,E;a(8237);(function(e){e["CHARACTER"]="CHARACTER",e["LANDSCAPE"]="LANDSCAPE",e["ANIMAL_COMPANION"]="ANIMAL_COMPANION",e["RESOURCE"]="RESOURCE",e["CRAFTED_ITEM"]="CRAFTED_ITEM",e["SEASON"]="SEASON",e["ACTION"]="ACTION"})(C||(C={})),function(e){e["STRENGTH"]="STRENGTH",e["WISDOM"]="WISDOM",e["AGILITY"]="AGILITY",e["DIPLOMACY"]="DIPLOMACY",e["SURVIVAL"]="SURVIVAL"}(L||(L={})),function(e){e["SAMHAIN"]="samhain",e["WINTERS_DEPTH"]="wintersDepth",e["IMBOLC"]="imbolc",e["BELTANE"]="beltane",e["LUGHNASADH"]="lughnasadh"}(E||(E={}));const T=(0,n.nY)("card",{state:()=>({characters:[],landscapes:[],animalCompanions:[],resources:[],craftedItems:[],seasons:[],initialized:!1}),getters:{getCharacterById:e=>t=>e.characters.find((e=>e.id===t)),getLandscapeById:e=>t=>e.landscapes.find((e=>e.id===t)),getAnimalCompanionById:e=>t=>e.animalCompanions.find((e=>e.id===t)),getCompanionById:e=>t=>e.animalCompanions.find((e=>e.id===t)),getResourceById:e=>t=>e.resources.find((e=>e.id===t)),getCraftedItemById:e=>t=>e.craftedItems.find((e=>e.id===t)),getSeasonById:e=>t=>e.seasons.find((e=>e.id===t)),getChallengeById:e=>t=>{const a=e.landscapes.reduce(((e,t)=>{if(t.challenges){const a=t.challenges.map((e=>({id:`${t.id}_${e.type.toLowerCase()}`,name:`${t.name} ${e.type}`,description:`A ${e.type} challenge at ${t.name}`,type:e.type,difficulty:e.difficulty,rewards:{resources:[],experience:10,knowledge:t.id}})));return[...e,...a]}return e}),[]);return a.find((e=>e.id===t))},getResourcesBySeason:e=>t=>e.resources.filter((e=>e.seasonalAbundance.includes(t))),getCompanionsBySeason:e=>t=>e.animalCompanions.filter((e=>e.affinitySeasons.includes(t))),getAllCraftedItems:e=>()=>e.craftedItems,getCraftableItems:e=>()=>e.craftedItems.map((e=>e.id))},actions:{initializeCards(){this.initializeCharacters(),this.initializeLandscapes(),this.initializeAnimalCompanions(),this.initializeResources(),this.initializeCraftedItems(),this.initializeSeasons(),this.initialized=!0},initializeCharacters(){this.characters=[{id:"character_1",name:"The Druid",description:"A keeper of ancient wisdom with a deep connection to nature.",type:C.CHARACTER,healthPoints:8,strength:6,wisdom:10,agility:6,diplomacy:8,survival:9,resourceCapacity:6,image:"/images/characters/druid.jpg",specialAbility:{name:"Nature's Harmony",description:"Can communicate with animals to gain insights about the landscape."},startingResources:["resource_1","resource_5"],startingCompanion:"companion_1"},{id:"character_2",name:"The Warrior",description:"A brave fighter skilled in combat and survival.",type:C.CHARACTER,healthPoints:12,strength:10,wisdom:6,agility:8,diplomacy:5,survival:8,resourceCapacity:4,image:"/images/characters/warrior.jpg",specialAbility:{name:"Battle Prowess",description:"Years of training have honed combat skills to perfection."},startingResources:["resource_2","resource_3"]},{id:"character_3",name:"The Bard",description:"A storyteller who carries the history and legends of the Celtic people.",type:C.CHARACTER,healthPoints:6,strength:5,wisdom:9,agility:7,diplomacy:10,survival:7,resourceCapacity:8,image:"/images/characters/bard.jpg",specialAbility:{name:"Ancient Tales",description:"Knowledge of old stories reveals secrets of the land."},startingResources:["resource_4","resource_7","resource_9"]},{id:"giant_beastfriend",name:"Giant Beastfriend",description:"A towering figure with a natural affinity for wild creatures, able to form bonds with even the most ferocious beasts.",type:C.CHARACTER,healthPoints:7,strength:8,wisdom:7,agility:5,diplomacy:4,survival:9,resourceCapacity:8,image:"/images/characters/giant_beastfriend.jpg",specialAbility:{name:"Animal Empathy",description:"Animal Companions cost -1 resource to bond with"},startingResources:["resource_3","resource_6"],challengeBonuses:{physical:3,mental:2,spiritual:3,social:1}},{id:"hedge_witch",name:"Hedge Witch/Warlock",description:"A practitioner of herbal magic and minor enchantments who dwells at the borderlands between civilization and wilderness.",type:C.CHARACTER,healthPoints:5,strength:4,wisdom:10,agility:6,diplomacy:5,survival:8,resourceCapacity:7,image:"/images/characters/hedge_witch.jpg",specialAbility:{name:"Herbal Knowledge",description:"Can substitute one resource for another when crafting"},startingResources:["resource_8","resource_10"],challengeBonuses:{physical:1,mental:3,spiritual:4,social:1}},{id:"iron_crafter",name:"Iron Crafter",description:"A master smith whose knowledge of metals and fire allows them to create items of remarkable power.",type:C.CHARACTER,healthPoints:6,strength:7,wisdom:8,agility:5,diplomacy:6,survival:6,resourceCapacity:6,image:"/images/characters/iron_crafter.jpg",specialAbility:{name:"Master Smith",description:"Crafting requires one fewer resource"},startingResources:["resource_2","resource_5"],challengeBonuses:{physical:3,mental:3,spiritual:1,social:2}},{id:"village_elder",name:"Village Elder",description:"A respected keeper of tradition and wisdom, whose connection to the community provides unique advantages.",type:C.CHARACTER,healthPoints:5,strength:3,wisdom:12,agility:4,diplomacy:9,survival:7,resourceCapacity:5,image:"/images/characters/village_elder.jpg",specialAbility:{name:"Ancient Wisdom",description:"Start with knowledge of entire journey path (all landscapes revealed at beginning)"},startingResources:["resource_7","resource_9"],challengeBonuses:{physical:1,mental:4,spiritual:3,social:3}}]},initializeLandscapes(){this.landscapes=[{id:"landscape_1",name:"The Misty Forest",description:"An ancient woodland shrouded in mist where spirits are said to dwell.",type:C.LANDSCAPE,challenges:[{id:"challenge_1",name:"Lost Path",description:"The mist has obscured the path, making navigation difficult.",type:L.WISDOM,difficulty:2,rewards:{resources:["resource_1","resource_5"],experience:1}},{id:"challenge_2",name:"Forest Guardian",description:"A mysterious entity blocks your path, demanding a tribute.",type:L.DIPLOMACY,difficulty:3,rewards:{resources:["resource_7"],experience:2,knowledge:"The forest spirits value respect above all else."}}],availableResources:["resource_1","resource_5","resource_8"],specialFeature:{name:"Ancient Grove",description:"A sacred place where druids once gathered.",effect:"Heal 1 health if you spend a turn meditating here."}},{id:"landscape_2",name:"The Standing Stones",description:"A circle of megalithic stones humming with ancient power.",type:C.LANDSCAPE,challenges:[{id:"challenge_3",name:"Ritual Alignment",description:"The stones must be aligned with the stars to unlock their power.",type:L.WISDOM,difficulty:4,rewards:{resources:["resource_10"],experience:2,knowledge:"The stones align with the seasonal transitions."}}],availableResources:["resource_2","resource_10"],specialFeature:{name:"Ley Line Nexus",description:"A powerful convergence of earth energies.",effect:"Your special ability can be used twice in this location."}}]},initializeAnimalCompanions(){this.animalCompanions=[{id:"companion_1",name:"Raven",description:"A wise bird associated with prophecy and insight.",type:C.ANIMAL_COMPANION,ability:{name:"Far Sight",description:"The raven scouts ahead, revealing dangers and opportunities.",effect:"Preview the next landscape before traveling there."},affinitySeasons:[E.SAMHAIN,E.WINTERS_DEPTH]},{id:"companion_2",name:"Wolf",description:"A loyal pack animal with keen senses.",type:C.ANIMAL_COMPANION,ability:{name:"Pack Hunter",description:"The wolf helps track and hunt for resources.",effect:"Gain an extra resource when gathering in a landscape."},affinitySeasons:[E.WINTERS_DEPTH,E.IMBOLC]},{id:"companion_3",name:"Stag",description:"A majestic forest dweller representing renewal and abundance.",type:C.ANIMAL_COMPANION,ability:{name:"Forest Guide",description:"The stag knows hidden paths through the wilderness.",effect:"Reduce the difficulty of navigation challenges by 1."},affinitySeasons:[E.BELTANE,E.LUGHNASADH]}]},initializeResources(){this.resources=[{id:"resource_1",name:"Healing Herbs",description:"Plants with medicinal properties that can restore health.",type:C.RESOURCE,rarity:"common",seasonalAbundance:[E.BELTANE,E.LUGHNASADH],specialEffect:{name:"Herbal Remedy",description:"A poultice made from these herbs can heal wounds.",effect:"Restore 1 health when used."}},{id:"resource_2",name:"Sacred Oak Wood",description:"Wood from the revered oak tree, imbued with strength.",type:C.RESOURCE,rarity:"uncommon",seasonalAbundance:[E.LUGHNASADH]},{id:"resource_3",name:"Iron Ore",description:"Raw metal used for crafting tools and weapons.",type:C.RESOURCE,rarity:"uncommon",seasonalAbundance:[E.IMBOLC,E.BELTANE]},{id:"resource_4",name:"Mistletoe",description:"A parasitic plant considered sacred by the druids.",type:C.RESOURCE,rarity:"rare",seasonalAbundance:[E.WINTERS_DEPTH],specialEffect:{name:"Druidic Focus",description:"Enhances spiritual connection when used in rituals.",effect:"Add +1 to wisdom challenges when used."}},{id:"resource_5",name:"Wild Berries",description:"Nutritious forest fruits that provide sustenance.",type:C.RESOURCE,rarity:"common",seasonalAbundance:[E.BELTANE,E.LUGHNASADH]}]},initializeCraftedItems(){this.craftedItems=[{id:"item_1",name:"Herbal Poultice",description:"A medicinal wrap made from healing herbs.",type:C.CRAFTED_ITEM,requiredResources:["resource_1","resource_5"],complexity:1,ability:{name:"Healing Touch",description:"Applies healing herbs directly to wounds.",effect:"Restore 2 health when used."}},{id:"item_2",name:"Oak Staff",description:"A sturdy staff carved from sacred oak wood.",type:C.CRAFTED_ITEM,requiredResources:["resource_2"],complexity:2,ability:{name:"Nature's Authority",description:"The staff channels the power of the oak.",effect:"Add +1 to all wisdom challenges."},drawback:{description:"The staff is heavy and cumbersome.",effect:"Reduce resource capacity by 1 while carried."}},{id:"item_3",name:"Iron Blade",description:"A simple but effective weapon forged from iron.",type:C.CRAFTED_ITEM,requiredResources:["resource_3"],complexity:3,ability:{name:"Sharp Edge",description:"The blade cuts through obstacles with ease.",effect:"Add +2 to strength challenges."}}]},initializeSeasons(){this.seasons=[{id:"season_1",name:"Samhain",description:"The Celtic new year, when the veil between worlds is thinnest.",type:C.SEASON,season:E.SAMHAIN,abundantResources:["resource_4"],scarceResources:["resource_1","resource_5"],animalAffinities:["companion_1"],effects:[{name:"Thin Veil",description:"The boundary between the mortal world and the Otherworld weakens.",effect:"Wisdom challenges are easier, but unexpected spirits may appear."}]},{id:"season_2",name:"Winter's Depth",description:"The coldest time of year, when survival is most challenging.",type:C.SEASON,season:E.WINTERS_DEPTH,abundantResources:[],scarceResources:["resource_1","resource_2","resource_5"],animalAffinities:["companion_1","companion_2"],effects:[{name:"Bitter Cold",description:"The harsh weather tests endurance and resourcefulness.",effect:"Lose 1 health at the end of each turn unless sheltered."}]},{id:"season_3",name:"Imbolc",description:"The first stirrings of spring, a time of purification and renewal.",type:C.SEASON,season:E.IMBOLC,abundantResources:["resource_3"],scarceResources:[],animalAffinities:["companion_2"],effects:[{name:"Renewal",description:"The land begins to awaken from winter's slumber.",effect:"Heal 1 health at the start of each turn."}]},{id:"season_4",name:"Beltane",description:"The height of spring, celebrating fertility and growth.",type:C.SEASON,season:E.BELTANE,abundantResources:["resource_1","resource_3","resource_5"],scarceResources:["resource_4"],animalAffinities:["companion_3"],effects:[{name:"Abundant Growth",description:"The land is lush with new life and energy.",effect:"Gather one additional resource per turn."}]},{id:"season_5",name:"Lughnasadh",description:"The harvest festival, celebrating the first fruits of the season.",type:C.SEASON,season:E.LUGHNASADH,abundantResources:["resource_1","resource_2","resource_5"],scarceResources:[],animalAffinities:["companion_3"],effects:[{name:"Harvest Bounty",description:"The land provides abundant resources before winter.",effect:"Resource capacity is increased by 2 during this season."}]}]}}});var b;a(1148);(function(e){e["SETUP"]="SETUP",e["CHARACTER_SELECTION"]="CHARACTER_SELECTION",e["SEASONAL_ASSESSMENT"]="SEASONAL_ASSESSMENT",e["THREAT_LEVEL_CHECK"]="THREAT_LEVEL_CHECK",e["LANDSCAPE_CHALLENGE"]="LANDSCAPE_CHALLENGE",e["CHALLENGE_RESOLUTION"]="CHALLENGE_RESOLUTION",e["RESOURCE_MANAGEMENT"]="RESOURCE_MANAGEMENT",e["ANIMAL_COMPANION"]="ANIMAL_COMPANION",e["CRAFTING"]="CRAFTING",e["JOURNEY_PROGRESSION"]="JOURNEY_PROGRESSION",e["GAME_OVER"]="GAME_OVER"})(b||(b={}));const S=(0,n.nY)("game",{state:()=>({currentPhase:b.SEASONAL_ASSESSMENT,currentTurn:1,currentSeason:E.SAMHAIN,currentLandscapeId:"",currentChallenge:null,visitedLandscapes:[],journeyProgress:0,journeyPath:[],gameLog:[],victoryConditions:{journeyCompleted:!1,balanceMaintained:!1,knowledgeAcquired:!1,bondsFormed:!1,questFulfilled:!1,landscapesTraversed:!1,seasonsExperienced:!1,challengesOvercome:!1},gameStarted:!1,gameOver:!1,isVictory:!1,threatTokens:0,blessingTokens:0,challengeHistory:[],tempEffects:[],journeyComplete:!1,wisdom:0,ceremonyCompleted:!1}),getters:{currentLandscape(){const e=T(),t=e.getLandscapeById(this.currentLandscapeId);return t||null},currentSeasonCard(){const e=T(),t=e.getSeasonById(this.currentSeason);return t||null},journeyPercentage(){return Math.min(100,Math.round(this.journeyProgress/10*100))},isGameOver(){return this.gameOver},hasWon(){return this.isVictory},formattedGameLog(){return[...this.gameLog].reverse()},threatLevel(){return Math.floor(this.threatTokens/3)},hasTempEffect(){return e=>this.tempEffects.some((t=>t.id===e&&t.duration>0))},getTempEffectStrength(){return e=>{const t=this.tempEffects.find((t=>t.id===e&&t.duration>0));return t?t.strength:0}}},actions:{startGame(){this.gameStarted=!0,this.currentPhase=b.SEASONAL_ASSESSMENT,this.currentTurn=1,this.currentSeason=E.SAMHAIN,this.threatTokens=0,this.tempEffects=[],this.addToGameLog("Your journey begins in the season of Samhain, when the veil between worlds is thinnest.",!0)},resetGame(){this.currentPhase=b.SEASONAL_ASSESSMENT,this.currentTurn=1,this.currentSeason=E.SAMHAIN,this.currentLandscapeId="",this.currentChallenge=null,this.visitedLandscapes=[],this.journeyProgress=0,this.journeyPath=[],this.gameLog=[],this.victoryConditions={journeyCompleted:!1,balanceMaintained:!1,knowledgeAcquired:!1,bondsFormed:!1,questFulfilled:!1,landscapesTraversed:!1,seasonsExperienced:!1,challengesOvercome:!1},this.gameStarted=!1,this.gameOver=!1,this.isVictory=!1,this.threatTokens=0,this.blessingTokens=0,this.challengeHistory=[],this.tempEffects=[]},endGame(e){this.gameOver=!0,this.isVictory=e,e?this.addToGameLog("Congratulations! You have completed your journey through the Celtic Realm.",!0):this.addToGameLog("Your journey has come to an end. The Celtic Realm remains shrouded in mystery.",!0),this.currentPhase=b.GAME_OVER},setPhase(e){this.currentPhase=e,this.addToGameLog(`Entering the ${this.formatPhase(e)} phase.`)},advancePhase(){const e=[b.SEASONAL_ASSESSMENT,b.THREAT_LEVEL_CHECK,b.LANDSCAPE_CHALLENGE,b.CHALLENGE_RESOLUTION,b.RESOURCE_MANAGEMENT,b.ANIMAL_COMPANION,b.CRAFTING,b.JOURNEY_PROGRESSION],t=e.indexOf(this.currentPhase);-1!==t&&(this.currentPhase=e[(t+1)%e.length],this.addToGameLog(`Entering the ${this.formatPhase(this.currentPhase)} phase.`,!0,"phase",{previousPhase:e[t],newPhase:this.currentPhase}),this.currentPhase===b.SEASONAL_ASSESSMENT&&this.advanceTurn())},advanceTurn(){this.currentTurn++,this.addToGameLog(`Turn ${this.currentTurn} has begun.`,!0,"system",{newTurn:this.currentTurn,currentSeason:this.formatSeason(this.currentSeason)}),this.processTempEffects(),this.currentTurn%3===0&&this.advanceSeason(),this.checkVictoryConditions()},advanceSeason(){const e=[E.SAMHAIN,E.WINTERS_DEPTH,E.IMBOLC,E.BELTANE,E.LUGHNASADH],t=e.indexOf(this.currentSeason);if(-1!==t){const a=(t+1)%e.length,s=this.currentSeason;this.currentSeason=e[a],this.addToGameLog(`The season has changed to ${this.formatSeason(this.currentSeason)}.`,!0,"phase",{previousSeason:this.formatSeason(s),newSeason:this.formatSeason(this.currentSeason),turn:this.currentTurn}),this.processSeasonalResourceChanges(s,this.currentSeason);const n=T(),o=n.getSeasonById(this.currentSeason);o&&(this.addToGameLog(`${o.name}: ${o.description}`,!1,"system",{seasonEffects:o.effects}),o.effects&&o.effects.length>0&&o.effects.forEach((e=>{const t="string"===typeof e.effect?e.effect:`${e.effect}`;this.addToGameLog(`Season Effect: ${e.name} - ${t}`,!1,"system",{effectDetails:e})})))}},setCurrentLandscape(e){const t=this.currentLandscapeId;this.currentLandscapeId=e,this.visitedLandscapes.includes(e)||this.addVisitedLandscape(e);const a=T(),s=a.getLandscapeById(e);s&&(this.addToGameLog(`You have arrived at ${s.name}.`,!0,"action",{previousLandscapeId:t,newLandscapeId:e,landscapeName:s.name,availableResources:s.availableResources,specialFeature:s.specialFeature,providesShelter:s.providesShelter}),s.entryEffect&&this.addToGameLog(`${s.name} Entry Effect: ${s.entryEffect.description}`,!1,"system",{entryEffect:s.entryEffect}),this.visitedLandscapes.length>=10&&(this.victoryConditions.landscapesTraversed=!0,this.addToGameLog("You have traversed enough landscapes to complete your journey.",!0,"system",{visitedLandscapes:this.visitedLandscapes.length,requiredLandscapes:10})))},addVisitedLandscape(e){if(!this.visitedLandscapes.includes(e)){this.visitedLandscapes.push(e);const t=T(),a=t.getLandscapeById(e);a&&(this.addToGameLog(`${a.name} has been added to your journey path.`,!1,"system",{landscapeId:e,landscapeName:a.name,visitedLandscapesCount:this.visitedLandscapes.length}),this.journeyPath.push(e),this.advanceJourney(1))}},setCurrentChallenge(e){const t=this.currentChallenge;if(this.currentChallenge=e,e){const a=T(),s=a.getChallengeById(e);if(s){const a=s.name||`${this.currentLandscape?.name||"Unknown"} Challenge`,n=s.type||"unknown",o=s.difficulty||5,r=s.rewards||{resources:[],experience:0};this.addToGameLog(`You face a challenge: ${a}`,!0,"challenge",{previousChallengeId:t,newChallengeId:e,challengeName:a,challengeType:n,challengeDifficulty:o,challengeRewards:r})}}else this.addToGameLog("The challenge has been cleared.",!1,"challenge",{previousChallengeId:t})},advanceJourney(e){const t=this.journeyProgress;this.journeyProgress+=e,this.addToGameLog(`Your journey has progressed by ${e} steps.`,!1,"action",{previousProgress:t,newProgress:this.journeyProgress,stepsAdded:e}),this.journeyProgress>=15&&(this.victoryConditions.journeyCompleted=!0,this.addToGameLog("You have completed your journey through the Celtic Realm!",!0,"system",{journeyProgress:this.journeyProgress,journeyCompleted:!0}),this.checkVictoryConditions()&&this.completeJourney(!0))},completeJourney(e){this.addToGameLog(e?"Congratulations! You have successfully completed your journey through the Celtic Realm!":"Your journey has come to an end, but not in victory.",!0,"system",{isVictory:e,journeyProgress:this.journeyProgress,victoryConditions:{...this.victoryConditions},visitedLandscapes:this.visitedLandscapes.length,currentTurn:this.currentTurn,currentSeason:this.formatSeason(this.currentSeason)}),this.endGame(e)},addToGameLog(e,t=!1,a="system",s={}){const n={message:e,timestamp:Date.now(),highlight:t,type:a,details:s,turn:this.currentTurn,season:this.currentSeason};"error"===a?console.error(n.message,s):"debug"===a?console.debug(n.message,s):console.log(n.message,s),this.gameLog.push(n),this.gameLog.length>100&&this.gameLog.shift()},checkVictoryConditions(){const e=Object.values(this.victoryConditions).every(Boolean);return e&&this.endGame(!0),e},formatPhase(e){return e.replace(/_/g," ").toLowerCase()},formatSeason(e){return e.replace(/_/g," ").toLowerCase()},addThreatTokens(e){const t=Math.floor(this.threatTokens/3);this.threatTokens+=e;const a=Math.floor(this.threatTokens/3);return a>t&&this.addToGameLog(`The threat level has increased to ${a}!`,!0),this.victoryConditions.balanceMaintained=this.threatTokens<6,this.threatTokens},removeThreatTokens(e){const t=Math.floor(this.threatTokens/3);this.threatTokens=Math.max(0,this.threatTokens-e);const a=Math.floor(this.threatTokens/3);return a<t&&this.addToGameLog(`The threat level has decreased to ${a}.`,!0),this.victoryConditions.balanceMaintained=this.threatTokens<6,this.threatTokens},addTempEffect(e,t,a,s,n){const o=this.tempEffects.findIndex((t=>t.id===e));-1!==o?(this.tempEffects[o].strength=s,this.tempEffects[o].duration=n):(this.tempEffects.push({id:e,name:t,description:a,strength:s,duration:n}),this.addToGameLog(`New effect: ${t} - ${a}`,!0))},removeTempEffect(e){const t=this.tempEffects.findIndex((t=>t.id===e));if(-1!==t){const e=this.tempEffects[t];return this.addToGameLog(`Effect ended: ${e.name}`,!0),this.tempEffects.splice(t,1),!0}return!1},processTempEffects(){this.tempEffects.forEach(((e,t)=>{e.duration>0&&(e.duration--,0===e.duration&&(this.addToGameLog(`Effect ended: ${e.name}`,!0),this.tempEffects.splice(t,1)))}))},clearGameLog(){this.gameLog=[],this.addToGameLog("Game log cleared.",!1,"system",{timestamp:Date.now()})},handleThreatLevelCheck(){const e=this.threatLevel;this.addToGameLog(`Threat Level Check: Current threat level is ${e}.`,!0),e>0&&this.addToGameLog(`Challenge difficulty increased by +${e} due to threat level.`),this.threatTokens>=10?(this.addToGameLog("DANGER: The otherworldly forces are manifesting! Rolling on the Otherworldly Manifestation table.",!0,"error"),this.triggerOtherworldlyManifestation()):this.threatTokens>=5&&(this.addToGameLog("WARNING: The spiritual balance is disturbed. Drawing a random event.",!0,"challenge"),this.triggerRandomEvent()),this.advancePhase()},triggerRandomEvent(){const e=[{id:"sudden_storm",name:"Sudden Storm",description:"Dark clouds gather suddenly, bringing a fierce storm.",effect:()=>{this.addToGameLog("The storm makes gathering resources more difficult. Resource capacity reduced by 1 temporarily.",!0),this.addTempEffect("storm","Sudden Storm","Resource capacity -1",1,2);const e=A();e.addEffect({id:"storm_effect",name:"Storm Hindrance",description:"Resource gathering diminished",type:"negative",magnitude:-1,duration:2,target:"resourceCapacity"})}},{id:"animal_migration",name:"Animal Migration",description:"A sudden migration of animals passes through the area.",effect:()=>{this.addToGameLog("The animal migration brings opportunity. Your next Animal Companion check gets +2.",!0),this.addTempEffect("migration","Animal Migration","Animal Companion checks +2",2,1)}},{id:"ancient_memory",name:"Ancient Memory",description:"The land itself seems to remember ancient events, stirring old magics.",effect:()=>{const e=A();e.gainExperience(1),this.addToGameLog("Ancient wisdom floods your mind. You gain 1 experience point.",!0)}},{id:"fae_mischief",name:"Fae Mischief",description:"The faerie folk play tricks on unwary travelers.",effect:()=>{this.addToGameLog("Your supplies have been tampered with by mischievous fae.",!0);const e=A();e.loseRandomResources(1)}},{id:"spiritual_blessing",name:"Spiritual Blessing",description:"The ancestral spirits take notice of your journey and offer aid.",effect:()=>{this.blessingTokens+=1,this.addToGameLog("You receive a blessing from the spirits. +1 Blessing token.",!0)}}],t=e[Math.floor(Math.random()*e.length)];this.addToGameLog(`Random Event: ${t.name} - ${t.description}`,!0),t.effect()},triggerOtherworldlyManifestation(){const e=[{id:"spirit_guardian",name:"Spirit Guardian",description:"A powerful guardian spirit manifests to test your worthiness.",effect:()=>{this.addToGameLog("The spirit guardian challenges you to prove your worth!",!0),this.addTempEffect("guardian_challenge","Spirit Guardian Challenge","Must succeed on next 2 challenges or lose 2 health",2,2),this.addToGameLog("You must succeed on your next two challenges or suffer 2 health damage.",!0)}},{id:"reality_distortion",name:"Reality Distortion",description:"The boundaries between worlds thin, causing strange distortions in reality.",effect:()=>{this.addToGameLog("Reality warps around you, changing your path!",!0);const e=T(),t=e.landscapes,a=t[Math.floor(Math.random()*t.length)];this.setCurrentLandscape(a.id),this.addToGameLog(`You suddenly find yourself at ${a.name}!`,!0)}},{id:"ancestral_curse",name:"Ancestral Curse",description:"Ancient spirits place a curse upon you for disturbing the balance.",effect:()=>{this.addToGameLog("An ancestral curse falls upon you!",!0);const e=A();e.addEffect({id:"ancestral_curse",name:"Ancestral Curse",description:"-1 to all challenge rolls",type:"negative",magnitude:-1,duration:3,target:"challengeRolls"}),this.addToGameLog("You feel weakened. -1 to all challenge rolls for 3 turns.",!0)}},{id:"otherworld_portal",name:"Otherworld Portal",description:"A portal to the Otherworld opens, risking pulling you in.",effect:()=>{if(this.addToGameLog("A swirling portal to the Otherworld appears before you!",!0),this.addThreatTokens(2),this.addToGameLog("The portal's energy increases the spiritual imbalance. +2 Threat tokens.",!0),this.addToGameLog("You sense that reaching into the portal could yield a valuable resource, but at great risk...",!0),Math.random()>.5){const e=A(),t=["silver_mistletoe","standing_stone_chips","amber_shards"][Math.floor(3*Math.random())];e.addResource(t),this.addToGameLog(`You reach into the portal and retrieve a rare resource: ${t.replace("_"," ")}!`,!0)}else{const e=A();e.loseHealth(2),this.addToGameLog("The portal's energy burns you as you reach in! You lose 2 health.",!0)}}},{id:"time_anomaly",name:"Time Anomaly",description:"Time flows strangely, affecting your progress and abilities.",effect:()=>{this.addToGameLog("Time becomes unstable around you!",!0),Math.random()>.5?(this.advanceSeason(),this.addToGameLog("Time accelerates, advancing the season prematurely!",!0)):(this.reverseSeason(),this.addToGameLog("Time flows backwards, returning to the previous season!",!0))}}],t=e[Math.floor(Math.random()*e.length)];this.addToGameLog(`Otherworldly Manifestation: ${t.name} - ${t.description}`,!0,"error"),t.effect()},reverseSeason(){const e=[E.SAMHAIN,E.WINTERS_DEPTH,E.IMBOLC,E.BELTANE,E.LUGHNASADH],t=e.indexOf(this.currentSeason);if(t>0){const a=e[t-1];this.currentSeason=a,this.addToGameLog(`The season has reversed to ${this.formatSeason(this.currentSeason)}.`,!0)}else this.addToGameLog("The season remains unchanged - you are already at the beginning of the cycle.",!0);this.updateSeasonCard()},handleHealingRecovery(){const e=A(),t=1,a=this.currentSeasonCard;let s=0;a&&(this.currentSeason===E.IMBOLC?s=1:this.currentSeason===E.LUGHNASADH&&(s=0,this.addToGameLog("The community support during Lughnasadh doubles your healing effectiveness.")));const n=t+s;if(e.health<e.maxHealth?(e.healHealth(n),this.addToGameLog(`You recover ${n} health during the healing phase.`,!0,"system")):this.addToGameLog("You are already at full health.",!1,"system"),this.currentLandscape&&["Sacred Oak Grove","Druid's Sanctuary","Moonlit Loch"].includes(this.currentLandscape.name)){const t=1;e.healHealth(t),this.addToGameLog(`The spiritual energy at this ${this.currentLandscape.name} provides an additional ${t} healing.`,!0)}this.advancePhase()},processSeasonalResourceChanges(e,t){const a=A(),s=T(),n=[...a.resources];this.addToGameLog("Checking resources for seasonal changes...",!1,"system");const o={[`${E.SAMHAIN}_${E.WINTERS_DEPTH}`]:["berries","mushrooms","fresh_herbs"],[`${E.WINTERS_DEPTH}_${E.IMBOLC}`]:["winter_roots","preserved_meats"],[`${E.IMBOLC}_${E.BELTANE}`]:["spring_flowers","birch_sap"],[`${E.BELTANE}_${E.LUGHNASADH}`]:["summer_fruits","fresh_water"],[`${E.LUGHNASADH}_${E.SAMHAIN}`]:["summer_fruits","fresh_water"]},r={[`${E.SAMHAIN}_${E.WINTERS_DEPTH}`]:{acorns:"winter_roots",fresh_herbs:"dried_herbs"},[`${E.WINTERS_DEPTH}_${E.IMBOLC}`]:{snow_essence:"spring_water",pine_needles:"spring_flowers"},[`${E.IMBOLC}_${E.BELTANE}`]:{spring_flowers:"summer_fruits",birch_sap:"sweet_syrup"},[`${E.BELTANE}_${E.LUGHNASADH}`]:{green_leaves:"red_leaves",summer_fruits:"fermented_fruit"}},i=`${e}_${t}`,l=o[i]||[],c=r[i]||{};n.forEach((e=>{if(l.includes(e)&&(a.removeResource(e),this.addToGameLog(`Your ${this.formatResourceName(e)} has spoiled with the change to ${this.formatSeason(t)}.`,!0,"resource")),e in c){const n=c[e];a.removeResource(e),a.addResource(n);const o=s.getResourceById(e),r=s.getResourceById(n),i=o?o.name:this.formatResourceName(e),l=r?r.name:this.formatResourceName(n);this.addToGameLog(`Your ${i} has transformed into ${l} with the change to ${this.formatSeason(t)}.`,!0,"resource")}})),this.updateResourceAvailability()},formatResourceName(e){return e.replace(/_/g," ")},updateResourceAvailability(){this.addToGameLog("Resource availability has adjusted to the new season.",!1,"system")},rollD8(){const e=Math.floor(8*Math.random())+1;return this.addToGameLog(`You rolled a ${e} on a D8.`,!0,"system"),e},resolveChallenge(e,t){return this.addToGameLog(`Challenge attempt: Roll ${e} vs Difficulty ${t}`,!0,"challenge"),e>=t+2?(this.addToGameLog("Critical Success! You overcome the challenge with exceptional results.",!0,"challenge"),this.currentChallenge&&this.challengeHistory.push({id:this.currentChallenge,outcome:"SUCCESS",turn:this.currentTurn}),this.removeThreatTokens(1),"SUCCESS"):e>=t?(this.addToGameLog("Success! You overcome the challenge.",!0,"challenge"),this.currentChallenge&&this.challengeHistory.push({id:this.currentChallenge,outcome:"SUCCESS",turn:this.currentTurn}),"SUCCESS"):e>=t-2?(this.addToGameLog("Partial Success. You manage to barely overcome parts of the challenge.",!0,"challenge"),this.currentChallenge&&this.challengeHistory.push({id:this.currentChallenge,outcome:"PARTIAL",turn:this.currentTurn}),this.addThreatTokens(1),"PARTIAL"):(this.addToGameLog("Failure. The challenge proves too difficult for now.",!0,"challenge"),this.currentChallenge&&this.challengeHistory.push({id:this.currentChallenge,outcome:"FAILURE",turn:this.currentTurn}),this.addThreatTokens(2),"FAILURE")},performSpecialAction(e){T();const t=A();switch(e){case"standing_stones_ceremony":return this.ceremonyCompleted=!0,this.journeyComplete=!0,t.wisdom=(t.wisdom||0)+5,this.addToGameLog("You have performed the ancient ceremony at the Standing Stones. Your journey is complete!",!0,"special"),{success:!0,message:"You have successfully completed the journey!"};case"heal_at_spring":return t.healHealth(5),this.addToGameLog("You drink from the sacred spring and feel revitalized.",!0,"special"),{success:!0,message:"You feel refreshed and healed."};case"meditation":return t.wisdom=(t.wisdom||0)+2,this.addToGameLog("You meditate peacefully, gaining insight and wisdom.",!0,"special"),{success:!0,message:"Your mind feels clearer and wiser."};default:return{success:!1,message:"That action is not available at this location."}}},gatherResources(){const e=A();T();if(!this.currentLandscape)return void this.addToGameLog("No landscape available to gather resources from.",!0,"error");const t=this.currentLandscape.availableResources||[];if(0===t.length)return void this.addToGameLog(`There are no resources available at ${this.currentLandscape.name}.`,!0,"resource");if(e.resources.length>=e.resourceCapacity)return void this.addToGameLog(`Your resource capacity (${e.resourceCapacity}) is full. You must discard resources before gathering more.`,!0,"resource");const a=5,s=this.getSeasonalResourceModifier(),n=Math.floor(this.threatTokens/3),o=a+n+s,r=this.rollD8(),i=e.wisdom||0,l=r+i,c=this.resolveChallenge(l,o);"SUCCESS"===c?(this.awardResources(2,t),this.addToGameLog(`Success! You've gathered resources from ${this.currentLandscape.name}.`,!0,"resource")):"PARTIAL"===c?(this.awardResources(1,t),this.addToGameLog(`Partial success. You've gathered a small amount of resources from ${this.currentLandscape.name}.`,!0,"resource")):this.addToGameLog(`You failed to gather any resources from ${this.currentLandscape.name}.`,!0,"resource"),this.currentSeason!==E.LUGHNASADH||"SUCCESS"!==c&&"PARTIAL"!==c||(this.addToGameLog("The harvest season blesses you with an additional resource.",!0,"resource"),this.awardResources(1,t))},awardResources(e,t){const a=A(),s=T(),n=a.resourceCapacity-a.resources.length;if(e=Math.min(e,n),e<=0)this.addToGameLog("Your resource capacity is full.",!0,"resource");else for(let o=0;o<e;o++){if(0===t.length)break;const e=Math.floor(Math.random()*t.length),n=t[e];a.addResource(n);const o=s.getResourceById(n),r=o?o.name:this.formatResourceName(n);this.addToGameLog(`You gathered ${r}.`,!1,"resource")}},getSeasonalResourceModifier(){switch(this.currentSeason){case E.SAMHAIN:return 1;case E.WINTERS_DEPTH:return 2;case E.IMBOLC:return 0;case E.BELTANE:return-1;case E.LUGHNASADH:return-2;default:return 0}}}});class k{checkVictoryConditions(){const e=this.checkJourneyCompletion(),t=this.checkBalanceMaintained(),a=this.checkKnowledgeAcquired(),s=this.checkBondsFormed(),n=this.checkPersonalQuest(),o=this.checkLandscapesTraversed(),r=this.checkSeasonsExperienced(),i=this.checkChallengesOvercome(),l={journeyCompleted:e,balanceMaintained:t,knowledgeAcquired:a,bondsFormed:s,questFulfilled:n,landscapesTraversed:o,seasonsExperienced:r,challengesOvercome:i},c=Object.values(l).every(Boolean),d=S();return d.victoryConditions=l,{isVictory:c,conditions:l}}checkJourneyCompletion(){const e=S();return e.visitedLandscapes.length>=15}checkBalanceMaintained(){const e=S();return e.threatTokens<6}checkKnowledgeAcquired(){const e=A();return e.craftedItems.length>=2}checkBondsFormed(){const e=A();return e.animalCompanions.length>=1}checkPersonalQuest(){const e=A(),t=T(),a=S(),s=t.getCharacterById(e.characterId);if(!s)return!1;switch(s.id){case"giant_beastfriend":return e.companionCount>=4;case"hedge_witch":return e.craftedItemCount>=3;case"iron_crafter":return e.craftedItemCount>=5;case"druid_seer":return a.visitedLandscapes.length>=10;case"celtic_warrior":return a.visitedLandscapes.length>=12;case"forest_guardian":return 0===a.threatTokens;default:return!1}}checkLandscapesTraversed(){const e=S();return e.visitedLandscapes.length>=10}checkSeasonsExperienced(){S();return!0}checkChallengesOvercome(){S();return!0}processVictory(){const e=S();e.endGame(!0),e.addToGameLog("Victory! You have completed your journey through the Celtic Realm.",!0)}processDefeat(e){const t=S();t.endGame(!1),t.addToGameLog(`Defeat: ${e}`,!0),t.addToGameLog(`Game Stats - Turns: ${t.currentTurn}, Threat: ${t.threatTokens}, Season: ${t.currentSeason}`,!1)}checkDefeatConditions(){const e=S(),t=A();return t.health<=0?{isDefeat:!0,reason:"Your journey has ended as your health has fallen to zero."}:e.threatTokens>=15?{isDefeat:!0,reason:"The otherworldly forces have overwhelmed you as threat tokens reached 15."}:e.currentTurn>=30?{isDefeat:!0,reason:"Your journey has taken too long, and winter has claimed you."}:{isDefeat:!1,reason:null}}}const R=new k,A=(0,n.nY)("player",{state:()=>({characterId:"",health:10,maxHealth:10,resources:[],resourceCapacity:5,animalCompanions:[],craftedItems:[],experience:0,knowledgeDiscovered:[],specialAbilityUsed:!1,activeEffects:[],hasCraftedLegendaryItem:!1,uniqueCraftedItemsCount:0,companionLoyalty:{},wisdom:0}),getters:{character(){const e=T(),t=e.getCharacterById(this.characterId);return t||null},resourceCount(){return this.resources.length},isResourceCapacityReached(){return this.resources.length>=this.resourceCapacity},companionCount(){return this.animalCompanions.length},craftedItemCount(){return this.craftedItems.length},experienceLevel(){return Math.floor(this.experience/3)+1},hasEffect(){return e=>this.activeEffects.some((t=>t.id===e&&t.duration>0))},getEffectStrength(){return e=>{const t=this.activeEffects.find((t=>t.id===e&&t.duration>0));return t?t.magnitude:0}}},actions:{setCharacter(e){const t=T(),a=t.getCharacterById(e);a&&(this.characterId=e,this.health=a.healthPoints,this.maxHealth=a.healthPoints,this.resourceCapacity=a.resourceCapacity,a.startingResources&&a.startingResources.forEach((e=>{this.addResource(e)})),a.startingCompanion&&this.addAnimalCompanion(a.startingCompanion),a.startingCompanions&&a.startingCompanions.forEach((e=>{this.addAnimalCompanion(e)})))},selectCharacter(e){return this.setCharacter(e),!0},addResource(e){return this.resources.length<this.resourceCapacity&&(this.resources.push(e),!0)},removeResource(e){const t=this.resources.indexOf(e);return-1!==t&&(this.resources.splice(t,1),!0)},addAnimalCompanion(e){return!this.animalCompanions.includes(e)&&(this.animalCompanions.push(e),this.companionLoyalty[e]={loyalty:5,state:m.LOYAL,turnsSinceLastFed:0,turnsWary:0},!0)},removeAnimalCompanion(e){const t=this.animalCompanions.indexOf(e);return-1!==t&&(this.animalCompanions.splice(t,1),this.companionLoyalty[e]&&delete this.companionLoyalty[e],!0)},feedCompanion(e,t){if(!this.animalCompanions.includes(e))return!1;if(!this.resources.includes(t))return!1;this.removeResource(t);const a=this.companionLoyalty[e];a||(this.companionLoyalty[e]={loyalty:5,state:m.LOYAL,turnsSinceLastFed:0,turnsWary:0});const s=this.companionLoyalty[e];s.turnsSinceLastFed=0,s.loyalty=Math.min(10,s.loyalty+1),s.state===m.WARY&&(s.state=m.LOYAL,s.turnsWary=0);const n=S();return n.addToGameLog(`You fed your animal companion with ${n.formatResourceName(t)}.`,!0,"companion"),!0},updateCompanionStatus(){const e=S(),t=T();this.animalCompanions.forEach((a=>{const s=this.companionLoyalty[a];if(!s)return;s.turnsSinceLastFed++;const n=t.getAnimalCompanionById(a),o=n?n.name:"Animal companion";s.state===m.LOYAL&&s.turnsSinceLastFed>=3&&(s.state=m.WARY,s.turnsWary=0,e.addToGameLog(`${o} has become wary due to lack of food.`,!0,"companion")),s.state===m.WARY&&(s.turnsWary++,s.turnsWary>=2&&(s.state=m.LEAVING,e.addToGameLog(`${o} is leaving you due to continued neglect.`,!0,"companion"))),s.state===m.LEAVING&&(this.removeAnimalCompanion(a),e.addToGameLog(`${o} has left you.`,!0,"companion"))}))},isCompanionInState(e,t){if(!this.animalCompanions.includes(e))return!1;const a=this.companionLoyalty[e];return!!a&&a.state===t},getCompanionsInState(e){return this.animalCompanions.filter((t=>{const a=this.companionLoyalty[t];return a&&a.state===e}))},addCraftedItem(e){return!this.craftedItems.includes(e)&&(this.craftedItems.push(e),!0)},removeCraftedItem(e){const t=this.craftedItems.indexOf(e);return-1!==t&&(this.craftedItems.splice(t,1),!0)},addExperience(e){return this.experience+=e,this.experience},gainExperience(e){return this.addExperience(e)},loseHealth(e){if(this.health=Math.max(0,this.health-e),this.health<=0){const e=R.checkDefeatConditions();e.isDefeat&&R.processDefeat(e.reason||"Your health has reached zero.")}return this.health>0},healHealth(e){return this.health=Math.min(this.maxHealth,this.health+e),this.health},discoverKnowledge(e){return!this.knowledgeDiscovered.includes(e)&&(this.knowledgeDiscovered.push(e),!0)},useSpecialAbility(){return!this.specialAbilityUsed&&(this.specialAbilityUsed=!0,!0)},resetSpecialAbility(){return this.specialAbilityUsed=!1,!0},resetPlayer(){this.characterId="",this.health=10,this.maxHealth=10,this.resources=[],this.resourceCapacity=5,this.animalCompanions=[],this.craftedItems=[],this.experience=0,this.knowledgeDiscovered=[],this.specialAbilityUsed=!1,this.activeEffects=[],this.hasCraftedLegendaryItem=!1,this.uniqueCraftedItemsCount=0,this.companionLoyalty={}},addCompanion(e){this.animalCompanions.includes(e)||(this.animalCompanions.push(e),this.companionLoyalty||(this.companionLoyalty={}),this.companionLoyalty[e]=1)},removeCompanion(e){this.animalCompanions=this.animalCompanions.filter((t=>t!==e)),this.companionLoyalty&&this.companionLoyalty[e]&&delete this.companionLoyalty[e]},setCompanionLoyalty(e,t){this.companionLoyalty||(this.companionLoyalty={}),this.companionLoyalty[e]=t},takeDamage(e){const t=S(),a=this.loseHealth(e);return t.addToGameLog(`You take ${e} damage. Health: ${this.health}/${this.maxHealth}`),a||(t.addToGameLog("You have been defeated!",!0),t.endGame(!1)),a},loseRandomResources(e){const t=S();let a=0;e=Math.min(e,this.resources.length);for(let s=0;s<e;s++)if(this.resources.length>0){const e=Math.floor(Math.random()*this.resources.length),s=this.resources[e],n=T(),o=n.getResourceById(s);this.resources.splice(e,1),a++,t.addToGameLog(`You lost ${o?o.name:"a resource"}.`)}return a},addEffect(e){const t=S(),a=this.activeEffects.findIndex((t=>t.id===e.id));return-1!==a?(this.activeEffects[a].magnitude=e.magnitude,this.activeEffects[a].duration=e.duration,t.addToGameLog(`Effect renewed: ${e.name}`,!0)):(this.activeEffects.push(e),t.addToGameLog(`New effect gained: ${e.name} - ${e.description}`,!0)),!0},removeEffect(e){const t=S(),a=this.activeEffects.findIndex((t=>t.id===e));if(-1!==a){const e=this.activeEffects[a];return t.addToGameLog(`Effect ended: ${e.name}`,!0),this.activeEffects.splice(a,1),!0}return!1},processEffects(){this.activeEffects.forEach(((e,t)=>{if(e.duration>0&&(e.duration--,0===e.duration)){const a=S();a.addToGameLog(`Effect ended: ${e.name}`,!0),this.activeEffects.splice(t,1)}}))},useCompanionAbility(e){if(!this.animalCompanions.includes(e))return!1;const t=this.companionLoyalty[e];if(!t||t.state!==m.LOYAL)return!1;const a=T(),s=S(),n=a.getCompanionById(e);return!!n&&(s.addToGameLog(`You use ${n.name}'s special ability: ${n.ability.description}`,!0,"companion"),!0)},getCompanionStatus(e){if(!this.animalCompanions.includes(e))return m.LEAVING;const t=this.companionLoyalty[e];return t?t.state:m.LOYAL},useCraftedItem(e){if(!this.craftedItems.includes(e))return!1;const t=T(),a=S(),s=t.getCraftedItemById(e);return!!s&&(a.addToGameLog(`You use ${s.name}: ${s.description}`,!0,"crafting"),!0)},useCompanionForChallenge(e){if(!this.animalCompanions.includes(e))return!1;const t=this.companionLoyalty[e];if(!t||t.state!==m.LOYAL)return!1;const a=T(),s=S(),n=a.getCompanionById(e);return!!n&&(s.addToGameLog(`${n.name} helps you with the challenge.`,!0,"companion"),!0)},useCompanionForNight(e){if(!this.animalCompanions.includes(e))return!1;const t=this.companionLoyalty[e];if(!t||t.state!==m.LOYAL)return!1;const a=T(),s=S(),n=a.getCompanionById(e);return!!n&&(s.addToGameLog(`${n.name} keeps watch over you during the night.`,!0,"companion"),!0)},getCraftableItems(){const e=T(),t=e.getAllCraftedItems().map((e=>e.id)),a=[];for(const s of t){const t=e.getCraftedItemById(s);if(!t||!t.requiredResources)continue;let n=!0;for(const e of t.requiredResources)if(!this.resources.includes(e)){n=!1;break}n&&a.push(s)}return a},craftItem(e){const t=T(),a=S(),s=t.getCraftedItemById(e);if(!s||!s.requiredResources)return!1;for(const n of s.requiredResources)if(!this.resources.includes(n))return!1;for(const n of s.requiredResources)this.removeResource(n);return this.addCraftedItem(e),a.addToGameLog(`You crafted ${s.name}.`,!0,"crafting"),!0},rest(){const e=S();return this.healHealth(1),e.addToGameLog(`You rest and recover. Health is now ${this.health}/${this.maxHealth}.`,!0,"system"),!0},useCompanionForGathering(e){if(!this.animalCompanions.includes(e))return!1;const t=this.companionLoyalty[e];if(!t||t.state!==m.LOYAL)return!1;const a=T(),s=S(),n=a.getCompanionById(e);return!!n&&(s.addToGameLog(`${n.name} helps you gather resources.`,!0,"companion"),!0)}}}),_={class:"game-card__header",style:{"border-top-left-radius":"12px","border-top-right-radius":"12px",padding:"10px","text-align":"center","background-color":"rgba(140, 120, 81, 0.25)"}},I={style:{margin:"0","font-size":"1.1rem","text-transform":"capitalize",color:"#5a3e2b","font-weight":"bold","letter-spacing":"0.5px"}},w={key:0,class:"game-card__subtitle",style:{"font-size":"0.8rem",opacity:"0.8",color:"#5a3e2b"}},N={style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)","font-size":"4rem",opacity:"0.07","pointer-events":"none",color:"#5a3e2b"}},O={class:"game-card__body",style:{"flex-grow":"1",display:"flex","align-items":"center","justify-content":"center","text-align":"center",padding:"15px","z-index":"1",color:"#5a3e2b"}},G={key:0,class:"game-card__footer",style:{"border-bottom-left-radius":"12px","border-bottom-right-radius":"12px",padding:"10px","text-align":"center","background-color":"rgba(140, 120, 81, 0.15)"}};function M(e,t,a,s,n,r){return(0,o.uX)(),(0,o.CE)("div",{class:(0,y.C4)(["game-card",e.cardTypeClass]),onClick:t[0]||(t[0]=t=>e.$emit("click",t)),style:{position:"relative","border-radius":"12px","aspect-ratio":"2.5/3.5","max-width":"220px",width:"100%",display:"flex","flex-direction":"column","box-shadow":"3px 3px 8px rgba(0,0,0,0.2)",overflow:"hidden",background:"linear-gradient(to bottom, #f0e6d2 0%, #e6d7b9 100%)",border:"2px solid #8c7851"}},[t[1]||(t[1]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"#f0e6d2",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"GameCard",-1)),(0,o.Lk)("div",_,[(0,o.Lk)("h3",I,(0,y.v_)(e.title),1),e.subtitle?((0,o.uX)(),(0,o.CE)("div",w,(0,y.v_)(e.subtitle),1)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",N,(0,y.v_)(e.getSuitSymbol()),1),(0,o.Lk)("div",O,[(0,o.RG)(e.$slots,"default",{},void 0,!0)]),e.$slots.footer?((0,o.uX)(),(0,o.CE)("div",G,[(0,o.RG)(e.$slots,"footer",{},void 0,!0)])):(0,o.Q3)("",!0)],2)}var x=(0,o.pM)({name:"GameCard",props:{title:{type:String,required:!0},subtitle:{type:String,default:""},cardType:{type:String,required:!0,validator:e=>Object.values(C).includes(e)},season:{type:String,default:null,validator:e=>null===e||Object.values(E).includes(e)}},computed:{cardTypeClass(){if(!this.cardType)return{};const e=this.cardType.toLowerCase(),t={[`game-card--${e.replace(/_/g,"-")}`]:!0};return this.cardType===C.SEASON&&this.season&&(t[this.season.toLowerCase()]=!0),t},cardTypeIdentifierClass(){if(!this.cardType)return"";switch(this.cardType){case C.LANDSCAPE:return"stone-arch-border";case C.ANIMAL_COMPANION:return"paw-print-corner";case C.RESOURCE:return"woven-basket";case C.CRAFTED_ITEM:return"anvil-symbol";case C.SEASON:return"wheel-symbol";case C.CHARACTER:return"silhouette-symbol";case C.ACTION:return"arrow-symbol";default:return""}}},methods:{getSuitSymbol(){switch(this.cardType){case C.LANDSCAPE:return"♣";case C.ANIMAL_COMPANION:return"♥";case C.RESOURCE:return"♦";case C.CRAFTED_ITEM:return"♠";case C.SEASON:return"★";case C.CHARACTER:return"✦";case C.ACTION:return"➜";default:return"•"}}},emits:["click"]});const P=(0,c.A)(x,[["render",M],["__scopeId","data-v-3bc056ac"]]);var D=P;const H={class:"game-setup"},B={class:"game-container"},F={class:"character-selection"},$={style:{"font-size":"10pt"}},Y={class:"character-stats",style:{"font-size":"10pt",background:"transparent"}},W={class:"stat",style:{background:"transparent"}},U={style:{"font-size":"9pt"}},X={class:"stat",style:{background:"transparent"}},j={style:{"font-size":"9pt"}},z={class:"character-abilities",style:{"font-size":"10pt"}};var q=(0,o.pM)({__name:"GameSetupView",setup(e){const t=(0,f.rd)(),a=A(),s=S(),n=T(),r=(0,v.KR)([]),i=(0,v.KR)(null),l=()=>{n.initialized||n.initializeCards(),r.value=n.characters},c=e=>e.specialAbility?.name||"",d=e=>e.specialAbility?.description||"",u=e=>{try{if(console.log("Starting game with character:",e.name),a.selectCharacter(e.id),s.startGame(),s.setPhase(b.SEASONAL_ASSESSMENT),s.addToGameLog(`You begin your journey as ${e.name}.`,!0,"system"),!s.currentLandscapeId){const e=n.landscapes;if(e.length>0){const t=e[0];if(s.setCurrentLandscape(t.id),t.challenges&&t.challenges.length>0){const e=t.challenges[0];s.setCurrentChallenge(e.id),console.log("Set initial challenge:",e.name)}}}console.log("Navigating to game board"),setTimeout((()=>{t.push("/game")}),50)}catch(o){console.error("Error starting game:",o),alert("There was an error starting your adventure. Please try again.")}};return l(),(e,t)=>((0,o.uX)(),(0,o.CE)("div",H,[(0,o.Lk)("div",B,[t[4]||(t[4]=(0,o.Fv)('<div class="game-header" data-v-6de09f1e><h1 class="game-title" data-v-6de09f1e>Game Setup</h1><p class="game-subtitle" data-v-6de09f1e>Choose your character and begin your journey through the mystical Celtic landscape.</p></div><div class="celtic-quote" data-v-6de09f1e> &quot;The journey through the Celtic Realm is one of discovery, challenge, and transformation.&quot; </div><h2 data-v-6de09f1e>Select Your Character</h2><p class="character-intro mb-4" data-v-6de09f1e> Each character brings unique abilities and challenges to your journey. Choose wisely, as your character&#39;s strengths and weaknesses will shape your path through the Celtic Realm. </p>',4)),(0,o.Lk)("div",F,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.value,(e=>((0,o.uX)(),(0,o.Wv)(D,{key:e.id,title:e.name,cardType:"CHARACTER",class:(0,y.C4)({selected:i.value&&i.value.id===e.id}),onClick:t=>u(e)},{default:(0,o.k6)((()=>[(0,o.Lk)("p",$,(0,y.v_)(e.description),1),(0,o.Lk)("div",Y,[(0,o.Lk)("div",W,[t[0]||(t[0]=(0,o.Lk)("span",{class:"stat-label",style:{"font-size":"9pt"}},"Health:",-1)),t[1]||(t[1]=(0,o.eW)()),(0,o.Lk)("span",U,(0,y.v_)(e.healthPoints),1)]),(0,o.Lk)("div",X,[t[2]||(t[2]=(0,o.Lk)("span",{class:"stat-label",style:{"font-size":"9pt"}},"Capacity:",-1)),t[3]||(t[3]=(0,o.eW)()),(0,o.Lk)("span",j,(0,y.v_)(e.resourceCapacity),1)])]),(0,o.Lk)("div",z,[(0,o.Lk)("strong",null,(0,y.v_)(c(e))+":",1),(0,o.eW)(" "+(0,y.v_)(d(e)),1)])])),_:2},1032,["title","class","onClick"])))),128))])])]))}});const V=(0,c.A)(q,[["__scopeId","data-v-6de09f1e"]]);var K=V;const J={class:"game-map",style:{border:"2px solid lightblue",position:"relative"}},Q={class:"game-map__content"},Z={class:"map-container"},ee={class:"map-grid"},te={class:"location-marker"},ae={class:"location-name"};function se(e,t,a,s,n,r){return(0,o.uX)(),(0,o.CE)("div",J,[t[1]||(t[1]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"GameMap",-1)),t[2]||(t[2]=(0,o.Lk)("h3",{class:"game-map__title"},"Journey Map",-1)),(0,o.Lk)("div",Q,[(0,o.Lk)("div",Z,[(0,o.Lk)("div",ee,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.journeyLocations,((t,a)=>((0,o.uX)(),(0,o.CE)("div",{key:a,class:(0,y.C4)(["map-location",{"map-location--active":a===e.currentLocationIndex,"map-location--visited":a<e.currentLocationIndex}])},[(0,o.Lk)("div",te,(0,y.v_)(a+1),1),(0,o.Lk)("div",ae,(0,y.v_)(t.name),1)],2)))),128))]),t[0]||(t[0]=(0,o.Lk)("div",{class:"map-path"},null,-1))])])])}var ne=(0,o.pM)({name:"GameMap",setup(){const e=S(),t=(0,v.KR)([{name:"Forest Edge",type:"forest"},{name:"River Crossing",type:"river"},{name:"Mountain Pass",type:"mountain"},{name:"Ancient Ruins",type:"ruins"},{name:"Valley Settlement",type:"settlement"}]),a=(0,o.EW)((()=>e.journeyProgress||0));return{journeyLocations:t,currentLocationIndex:a}}});const oe=(0,c.A)(ne,[["render",se],["__scopeId","data-v-11ad1a66"]]);var re=oe;const ie={class:"resource-management"},le={key:0,class:"resource-management__inactive"},ce={key:1,class:"resource-management__active"},de={class:"resource-management__inventory"},ue={key:0,class:"empty-state"},he={key:1,class:"resource-grid"},pe=["onClick"],me={key:0,class:"resource-type mt-3"},ge={key:1,class:"resource-seasons mt-3"},fe={class:"season-tags"},ye={key:2,class:"resource-special-effect mt-3"},ve={key:0,class:"resource-management__actions mt-4"},Ce=["disabled"],Le={class:"resource-management__continue mt-4"};function Ee(e,t,a,s,n,r){const i=(0,o.g2)("GameCard");return(0,o.uX)(),(0,o.CE)("div",ie,[t[7]||(t[7]=(0,o.Lk)("h3",{class:"resource-management__title"},"Resource Management",-1)),e.currentPhase!==e.GamePhase.RESOURCE_MANAGEMENT?((0,o.uX)(),(0,o.CE)("div",le,t[4]||(t[4]=[(0,o.Lk)("p",null,"Resource management is not available during the current phase.",-1)]))):((0,o.uX)(),(0,o.CE)("div",ce,[(0,o.Lk)("div",de,[(0,o.Lk)("h4",null,"Your Resources ("+(0,y.v_)(e.playerResources.length)+" / "+(0,y.v_)(e.resourceCapacity)+")",1),0===e.playerResources.length?((0,o.uX)(),(0,o.CE)("div",ue," You don't have any resources. Explore landscapes to gather resources. ")):((0,o.uX)(),(0,o.CE)("div",he,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.playerResources,(a=>((0,o.uX)(),(0,o.CE)("div",{key:a.id,class:(0,y.C4)(["resource-grid__item",{selected:e.selectedResourceId===a.id}]),onClick:t=>e.selectResource(a)},[(0,o.bF)(i,{title:a.name,subtitle:"Resource",cardType:e.CardType.RESOURCE},{default:(0,o.k6)((()=>[(0,o.Lk)("p",null,(0,y.v_)(a.description),1),a.rarity?((0,o.uX)(),(0,o.CE)("div",me,[(0,o.Lk)("h5",null,"Rarity: "+(0,y.v_)(a.rarity),1),(0,o.Lk)("p",null,(0,y.v_)(e.getRarityDescription(a.rarity)),1)])):(0,o.Q3)("",!0),a.seasonalAbundance&&a.seasonalAbundance.length?((0,o.uX)(),(0,o.CE)("div",ge,[t[5]||(t[5]=(0,o.Lk)("h5",null,"Seasonal Availability",-1)),(0,o.Lk)("div",fe,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.seasonalAbundance,(t=>((0,o.uX)(),(0,o.CE)("span",{key:t,class:(0,y.C4)(["season-tag",e.getSeasonClassName(t)])},(0,y.v_)(e.formatSeasonName(t)),3)))),128))])])):(0,o.Q3)("",!0),a.specialEffect?((0,o.uX)(),(0,o.CE)("div",ye,[t[6]||(t[6]=(0,o.Lk)("h5",null,"Special Effect",-1)),(0,o.Lk)("p",null,(0,y.v_)(a.specialEffect.description),1)])):(0,o.Q3)("",!0)])),_:2},1032,["title","cardType"])],10,pe)))),128))]))]),e.selectedResourceId?((0,o.uX)(),(0,o.CE)("div",ve,[(0,o.Lk)("button",{class:"btn btn--primary",onClick:t[0]||(t[0]=(...t)=>e.useResource&&e.useResource(...t)),disabled:!e.canUseSelectedResource}," Use Resource ",8,Ce),(0,o.Lk)("button",{class:"btn btn--secondary ml-2",onClick:t[1]||(t[1]=(...t)=>e.discardResource&&e.discardResource(...t))}," Discard Resource "),(0,o.Lk)("button",{class:"btn btn--accent ml-2",onClick:t[2]||(t[2]=(...t)=>e.cancelSelection&&e.cancelSelection(...t))}," Cancel ")])):(0,o.Q3)("",!0),(0,o.Lk)("div",Le,[(0,o.Lk)("button",{class:"btn btn--primary btn--lg",onClick:t[3]||(t[3]=(...t)=>e.continueJourney&&e.continueJourney(...t))}," Continue Journey ")])]))])}var Te=(0,o.pM)({name:"ResourceManagement",components:{GameCard:D},setup(){const e=T(),t=A(),a=S(),s=(0,v.KR)(null),n=(0,o.EW)((()=>a.currentPhase)),r=(0,o.EW)((()=>{const a=t.resources;return a.map((t=>e.getResourceById(t))).filter(Boolean)})),i=(0,o.EW)((()=>t.resourceCapacity)),l=(0,o.EW)((()=>s.value&&r.value.find((e=>e.id===s.value))||null)),c=(0,o.EW)((()=>!!l.value&&!!l.value.specialEffect)),d=e=>{s.value=e.id},u=()=>{if(!l.value)return;const e=l.value;e.specialEffect&&(a.addToGameLog(`Used ${e.name}: ${e.specialEffect.description}`),t.removeResource(e.id),s.value=null)},h=()=>{l.value&&(t.removeResource(l.value.id),a.addToGameLog(`Discarded ${l.value.name}`),s.value=null)},p=()=>{s.value=null},m=()=>{a.advancePhase()},g=e=>"string"===typeof e?e.toLowerCase().replace(/_/g,"-"):"",f=e=>{if("string"!==typeof e)return"Unknown Season";switch(e){case E.SAMHAIN:return"Samhain";case E.WINTERS_DEPTH:return"Winter's Depth";case E.IMBOLC:return"Imbolc";case E.BELTANE:return"Beltane";case E.LUGHNASADH:return"Lughnasadh";default:return e.replace(/_/g," ").replace(/\b\w/g,(e=>e.toUpperCase())).replace("Winters Depth","Winter's Depth")}},y=e=>{switch(e){case"common":return"Commonly found throughout the Celtic Realm.";case"uncommon":return"Somewhat rare, but can be found in specific locations.";case"rare":return"Very rare and valuable, found only in special circumstances.";default:return"Unknown rarity."}};return{currentPhase:n,GamePhase:b,CardType:C,playerResources:r,resourceCapacity:i,selectedResource:l,selectedResourceId:s,canUseSelectedResource:c,selectResource:d,useResource:u,discardResource:h,cancelSelection:p,continueJourney:m,formatSeasonName:f,getSeasonClassName:g,getRarityDescription:y}}});const be=(0,c.A)(Te,[["render",Ee],["__scopeId","data-v-754d0e67"]]);var Se=be;const ke={class:"crafting-station",style:{border:"2px solid lightblue",position:"relative"}},Re={key:0,class:"crafting-station__inactive"},Ae={key:1,class:"crafting-station__active"},_e={class:"crafting-station__recipes"},Ie={key:0,class:"empty-state"},we={key:1,class:"recipe-list"},Ne=["onClick"],Oe={class:"recipe-complexity"},Ge={class:"recipe-resources"},Me={key:0,class:"crafting-station__details"},xe={class:"item-ability mt-3"},Pe={class:"ability-description"},De={key:0,class:"item-drawback mt-3"},He={class:"drawback-description"},Be={class:"item-resources mt-3"},Fe={class:"resource-requirements"},$e={class:"resource-status"},Ye={class:"crafting-actions mt-4"},We=["disabled"],Ue={key:1,class:"crafting-station__placeholder"};function Xe(e,t,a,s,n,r){return(0,o.uX)(),(0,o.CE)("div",ke,[t[8]||(t[8]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"CraftingStation",-1)),t[9]||(t[9]=(0,o.Lk)("h3",{class:"crafting-station__title"},"Crafting Station",-1)),e.currentPhase!==e.GamePhase.CRAFTING?((0,o.uX)(),(0,o.CE)("div",Re,t[2]||(t[2]=[(0,o.Lk)("p",null,"Crafting is not available during the current phase.",-1)]))):((0,o.uX)(),(0,o.CE)("div",Ae,[(0,o.Lk)("div",_e,[t[4]||(t[4]=(0,o.Lk)("h4",null,"Available Recipes",-1)),0===e.availableRecipes.length?((0,o.uX)(),(0,o.CE)("div",Ie," You don't have enough resources to craft any items. ")):((0,o.uX)(),(0,o.CE)("div",we,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.availableRecipes,(a=>((0,o.uX)(),(0,o.CE)("div",{key:a.id,class:(0,y.C4)(["recipe-list__item",{selected:e.selectedRecipe?.id===a.id}]),onClick:t=>e.selectRecipe(a)},[(0,o.Lk)("h5",null,(0,y.v_)(a.name),1),(0,o.Lk)("div",Oe,"Complexity: "+(0,y.v_)(a.complexity),1),(0,o.Lk)("div",Ge,[t[3]||(t[3]=(0,o.Lk)("div",null,"Required Resources:",-1)),(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.requiredResources,(t=>((0,o.uX)(),(0,o.CE)("li",{key:t},[(0,o.eW)((0,y.v_)(e.getResourceName(t))+" ",1),(0,o.Lk)("span",{class:(0,y.C4)(["resource-status",{available:e.hasResource(t),missing:!e.hasResource(t)}])},(0,y.v_)(e.hasResource(t)?"✓":"✗"),3)])))),128))])])],10,Ne)))),128))]))]),e.selectedRecipe?((0,o.uX)(),(0,o.CE)("div",Me,[(0,o.Lk)("h4",null,(0,y.v_)(e.selectedRecipe.name),1),(0,o.Lk)("p",null,(0,y.v_)(e.selectedRecipe.description),1),(0,o.Lk)("div",xe,[(0,o.Lk)("h5",null,"Ability: "+(0,y.v_)(e.selectedRecipe.ability.name),1),(0,o.Lk)("p",Pe,(0,y.v_)(e.selectedRecipe.ability.description),1)]),e.selectedRecipe.drawback?((0,o.uX)(),(0,o.CE)("div",De,[t[5]||(t[5]=(0,o.Lk)("h5",null,"Drawback",-1)),(0,o.Lk)("p",He,(0,y.v_)(e.selectedRecipe.drawback.description),1)])):(0,o.Q3)("",!0),(0,o.Lk)("div",Be,[t[6]||(t[6]=(0,o.Lk)("h5",null,"Required Resources",-1)),(0,o.Lk)("ul",Fe,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.selectedRecipe.requiredResources,(t=>((0,o.uX)(),(0,o.CE)("li",{key:t,class:(0,y.C4)({available:e.hasResource(t),missing:!e.hasResource(t)})},[(0,o.eW)((0,y.v_)(e.getResourceName(t))+" ",1),(0,o.Lk)("span",$e,(0,y.v_)(e.hasResource(t)?"✓":"✗"),1)],2)))),128))])]),(0,o.Lk)("div",Ye,[(0,o.Lk)("button",{class:"btn btn--primary",onClick:t[0]||(t[0]=(...t)=>e.craftItem&&e.craftItem(...t)),disabled:!e.canCraftSelectedRecipe}," Craft Item ",8,We),(0,o.Lk)("button",{class:"btn btn--secondary ml-2",onClick:t[1]||(t[1]=(...t)=>e.cancelCrafting&&e.cancelCrafting(...t))}," Cancel ")])])):((0,o.uX)(),(0,o.CE)("div",Ue,t[7]||(t[7]=[(0,o.Lk)("p",null,"Select a recipe to view details and craft an item.",-1)])))]))])}var je,ze,qe,Ve=a(1114);a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698);(function(e){e["RESOURCE_LOSS"]="RESOURCE_LOSS",e["HEALTH_LOSS"]="HEALTH_LOSS",e["CHALLENGE_DIFFICULTY"]="CHALLENGE_DIFFICULTY",e["COMPANION_EFFECT"]="COMPANION_EFFECT",e["LANDSCAPE_EFFECT"]="LANDSCAPE_EFFECT",e["SEASONAL_SHIFT"]="SEASONAL_SHIFT"})(je||(je={})),function(e){e["MINOR"]="MINOR",e["MODERATE"]="MODERATE",e["MAJOR"]="MAJOR"}(ze||(ze={})),function(e){e["MIST_WRAITH"]="MIST_WRAITH",e["BARROW_WIGHT"]="BARROW_WIGHT",e["FAERIE_ENTICEMENT"]="FAERIE_ENTICEMENT",e["WILD_HUNT"]="WILD_HUNT",e["ANCIENT_GUARDIAN"]="ANCIENT_GUARDIAN",e["BOUNDARY_COLLAPSE"]="BOUNDARY_COLLAPSE",e["SPIRIT_POSSESSION"]="SPIRIT_POSSESSION",e["COSMIC_IMBALANCE"]="COSMIC_IMBALANCE"}(qe||(qe={}));class Ke{constructor(){(0,Ve.A)(this,"gameStore",S()),(0,Ve.A)(this,"playerStore",A()),(0,Ve.A)(this,"cardStore",T()),(0,Ve.A)(this,"threatReductionThisTurn",0),(0,Ve.A)(this,"MAX_THREAT_REDUCTION_PER_TURN",3),(0,Ve.A)(this,"SACRED_SITES",{MOONLIT_LOCH:"moonlit_loch",DRUIDS_SANCTUARY:"druids_sanctuary"}),(0,Ve.A)(this,"THREAT_RESOURCES",{SACRED_WATER:"sacred_water",ROWAN_WOOD:"rowan_wood"}),(0,Ve.A)(this,"hasPerformedSeasonalRitual",!1),(0,Ve.A)(this,"threatEvents",[{id:"threat_event_1",name:"Unsettling Whispers",description:"Strange whispers echo through the landscape, causing unease.",type:ze.MINOR,manifestation:je.CHALLENGE_DIFFICULTY,strength:1,duration:2},{id:"threat_event_2",name:"Sudden Chill",description:"A bone-deep chill sets in, making it harder to perform tasks.",type:ze.MINOR,manifestation:je.HEALTH_LOSS,strength:1,duration:1},{id:"threat_event_3",name:"Misplaced Supplies",description:"Some of your resources have mysteriously gone missing.",type:ze.MINOR,manifestation:je.RESOURCE_LOSS,strength:1,duration:1},{id:"threat_event_4",name:"Otherworldly Fog",description:"A thick, unnatural fog descends, obscuring paths and hiding dangers.",type:ze.MODERATE,manifestation:je.LANDSCAPE_EFFECT,strength:2,duration:3},{id:"threat_event_5",name:"Animal Unrest",description:"Animals in the area become agitated and difficult to approach.",type:ze.MODERATE,manifestation:je.COMPANION_EFFECT,strength:2,duration:2},{id:"threat_event_6",name:"Weakening Boundaries",description:"The veil between worlds thins, allowing strange energies to seep through.",type:ze.MODERATE,manifestation:je.CHALLENGE_DIFFICULTY,strength:2,duration:3},{id:"threat_event_7",name:"Seasonal Disruption",description:"The natural cycle of seasons is disrupted, causing environmental chaos.",type:ze.MAJOR,manifestation:je.SEASONAL_SHIFT,strength:3,duration:4},{id:"threat_event_8",name:"Otherworldly Manifestation",description:"A powerful entity from beyond manifests, draining life force from all it encounters.",type:ze.MAJOR,manifestation:je.HEALTH_LOSS,strength:3,duration:3},{id:"threat_event_9",name:"Resource Blight",description:"A mysterious blight affects resources in the area, causing them to wither or spoil.",type:ze.MAJOR,manifestation:je.RESOURCE_LOSS,strength:3,duration:4}]),(0,Ve.A)(this,"otherworldlyManifestations",[{id:"manifestation_1",name:"Mist Wraith",description:"Obscures path, requires Amber Shards to banish",type:ze.MAJOR,manifestation:je.LANDSCAPE_EFFECT,strength:2,duration:3,counterResource:"amber_shards"},{id:"manifestation_2",name:"Barrow Wight",description:"Drains health each turn, must outrun or confront",type:ze.MAJOR,manifestation:je.HEALTH_LOSS,strength:2,duration:3,requiresChallenge:!0},{id:"manifestation_3",name:"Faerie Enticement",description:"Attempts to lead you astray, requires willpower challenge",type:ze.MAJOR,manifestation:je.CHALLENGE_DIFFICULTY,strength:2,duration:2,challengeType:"mental"},{id:"manifestation_4",name:"Wild Hunt",description:"Pursues you for 1d4 turns, must hide or join the hunt",type:ze.MAJOR,manifestation:je.CHALLENGE_DIFFICULTY,strength:3,duration:Math.floor(4*Math.random())+1,challengeType:"physical"},{id:"manifestation_5",name:"Ancient Guardian",description:"Blocks path, requires specific offering or riddling",type:ze.MAJOR,manifestation:je.LANDSCAPE_EFFECT,strength:3,duration:2,requiresOffering:!0},{id:"manifestation_6",name:"Boundary Collapse",description:"Seasons blur, unpredictable effects each turn",type:ze.MAJOR,manifestation:je.SEASONAL_SHIFT,strength:3,duration:4},{id:"manifestation_7",name:"Spirit Possession",description:"Animal Companion turns against you",type:ze.MAJOR,manifestation:je.COMPANION_EFFECT,strength:3,duration:3},{id:"manifestation_8",name:"Cosmic Imbalance",description:"All challenges +2 difficulty until balance restored",type:ze.MAJOR,manifestation:je.CHALLENGE_DIFFICULTY,strength:2,duration:4}])}addThreatTokens(e){return this.gameStore.addThreatTokens(e)}removeThreatTokens(e){const t=this.MAX_THREAT_REDUCTION_PER_TURN-this.threatReductionThisTurn;if(t<=0)return this.gameStore.addToGameLog("Maximum threat reduction reached for this turn.",!0),this.gameStore.threatTokens;const a=Math.min(e,t);return this.threatReductionThisTurn+=a,a<e&&this.gameStore.addToGameLog(`Reduced ${a} threat tokens (limit reached for this turn).`,!0),this.gameStore.removeThreatTokens(a)}resetThreatReductionTracker(){this.threatReductionThisTurn=0}getThreatLevel(){return Math.floor(this.gameStore.threatTokens/3)}hasThreatPrevention(){return this.playerStore.hasEffect("threat_prevention")}generateRandomThreatEvent(){const e=this.getThreatLevel();if(0===e)return null;let t=[];if(t=1===e?this.threatEvents.filter((e=>e.type===ze.MINOR)):2===e?this.threatEvents.filter((e=>e.type===ze.MINOR||e.type===ze.MODERATE)):this.threatEvents,t.length>0){const e=Math.floor(Math.random()*t.length);return t[e]}return null}applyThreatEvent(e){if(this.hasThreatPrevention())this.gameStore.addToGameLog(`${e.name} was prevented by your protective effects!`,!0);else switch(this.gameStore.addToGameLog(`Threat manifests: ${e.name} - ${e.description}`,!0),e.manifestation){case je.HEALTH_LOSS:this.playerStore.takeDamage(e.strength),this.gameStore.addToGameLog(`You lose ${e.strength} health from the threat.`);break;case je.RESOURCE_LOSS:this.playerStore.loseRandomResources(e.strength),this.gameStore.addToGameLog(`You lose ${e.strength} random resources from the threat.`);break;case je.CHALLENGE_DIFFICULTY:this.gameStore.addTempEffect("threat_challenge_difficulty","Increased Challenge Difficulty",`Challenges are ${e.strength} points more difficult due to threat.`,e.strength,e.duration);break;case je.COMPANION_EFFECT:this.gameStore.addTempEffect("threat_companion_effect","Companion Unrest","Animal companions are less effective due to threat.",e.strength,e.duration);break;case je.LANDSCAPE_EFFECT:this.gameStore.addTempEffect("threat_landscape_effect","Landscape Disruption","Resource gathering is reduced due to threat.",e.strength,e.duration);break;case je.SEASONAL_SHIFT:this.gameStore.addTempEffect("threat_seasonal_shift","Seasonal Disruption","Seasonal benefits are reduced due to threat.",e.strength,e.duration),e.type===ze.MAJOR&&this.gameStore.advanceSeason();break}}manifestThreat(){if(this.hasThreatPrevention())return this.gameStore.addToGameLog("Your protective effects prevented a threat manifestation!",!0),null;const e=this.generateRandomThreatEvent();return e?(this.applyThreatEvent(e),e):null}shouldManifestThreat(){const e=this.getThreatLevel();if(0===e)return!1;const t=.15*e;return Math.random()<t}addThreatPreventionEffect(e,t=1){const a={id:"threat_prevention",name:"Threat Prevention",description:"Prevents threat manifestations from affecting you.",magnitude:t,duration:e,type:"protection",target:"player"};this.playerStore.addEffect(a),this.gameStore.addToGameLog(`You are now protected from threats for ${e} turns.`,!0)}processThreatEffects(){this.resetThreatReductionTracker(),this.shouldManifestThreat()&&this.manifestThreat(),this.gameStore.threatTokens>=10&&this.rollForOtherworldlyManifestation()}useSacredSiteForThreatReduction(e){if(e===this.SACRED_SITES.MOONLIT_LOCH){const e=Math.floor(3*Math.random())+1;return this.gameStore.addToGameLog(`You performed a purification ritual at the Moonlit Loch, reducing threat by ${e}.`,!0),this.removeThreatTokens(e)}return e===this.SACRED_SITES.DRUIDS_SANCTUARY?(this.gameStore.addToGameLog("You meditated at the Druid's Sanctuary, reducing threat by 2.",!0),this.removeThreatTokens(2)):0}useResourceForThreatReduction(e){const t=A();if(e===this.THREAT_RESOURCES.SACRED_WATER){if(this.removeThreatTokens(1)>0)return t.removeResource(e),this.gameStore.addToGameLog("You used Sacred Water to purify and reduce threat by 1.",!0),!0}else if(e===this.THREAT_RESOURCES.ROWAN_WOOD)return t.removeResource(e),this.gameStore.addTempEffect("threat_prevention_rowan","Rowan Protection","Protected from threat accumulation by Rowan Wood.",1,1),this.gameStore.addToGameLog("You used Rowan Wood to ward against the next threat accumulation.",!0),!0;return!1}performSeasonalPurificationRitual(){const e=this.gameStore,t=e.currentSeason;if(this.hasPerformedSeasonalRitual)return e.addToGameLog("You have already performed a purification ritual this season.",!0),0;let a=1,s="";switch(t){case E.IMBOLC:s="Imbolc Purification",a=3;break;case E.BELTANE:s="Spring Renewal Ritual",a=2;break;case E.LUGHNASADH:s="Summer Solstice Ceremony",a=3;break;case E.SAMHAIN:s="Autumn Harvest Offering",a=2;break;case E.WINTERS_DEPTH:s="Winter Solstice Vigil",a=1;break}return this.hasPerformedSeasonalRitual=!0,e.addToGameLog(`You performed the ${s}, reducing threat by ${a}.`,!0),this.removeThreatTokens(a)}resetSeasonalRitualTracker(){this.hasPerformedSeasonalRitual=!1}rollForOtherworldlyManifestation(){if(this.gameStore.threatTokens<10)return null;const e=Math.floor(8*Math.random())+1,t=this.otherworldlyManifestations[e-1];return this.gameStore.addToGameLog(`Otherworldly Manifestation: ${t.name} - ${t.description}`,!0),this.applyThreatEvent(t),t}isSacredSite(e){return e===this.SACRED_SITES.MOONLIT_LOCH||e===this.SACRED_SITES.DRUIDS_SANCTUARY}isResourceUsefulForThreat(e){return e===this.THREAT_RESOURCES.SACRED_WATER||e===this.THREAT_RESOURCES.ROWAN_WOOD}getThreatForCraftedItem(e){const t=this.cardStore.getCraftedItemById(e);if(!t)return 0;if(t.complexity){const e="number"===typeof t.complexity?t.complexity:this.getComplexityValue(t.complexity);if(e>=4)return 3;if(e>=3)return 2;if(e>=2)return 1}return 0}getComplexityValue(e){switch(e){case"LEGENDARY":return 4;case"ADVANCED":return 3;case"COMPLEX":return 2;case"SIMPLE":default:return 1}}addThreatForSeasonalCrossing(){return this.addThreatTokens(2)}addThreatForSacredSiteDisrespect(e,t=1){if(this.isSacredSite(e)){const e=Math.max(1,Math.min(3,t));return this.gameStore.addToGameLog(`Your actions have disrespected a sacred site, increasing threat by ${e}.`,!0),this.addThreatTokens(e)}return 0}handleSeasonChange(e,t){this.resetSeasonalRitualTracker();const a=this.playerStore;let s=!1;t===E.WINTERS_DEPTH?s=a.resources.some((e=>["woven_reeds","forge_cinders"].includes(e))):t===E.IMBOLC?s=a.resources.some((e=>["rowan_wood","silver_mistletoe"].includes(e))):t===E.BELTANE?s=a.resources.some((e=>["oak_galls","amber_shards"].includes(e))):t===E.LUGHNASADH?s=a.resources.some((e=>["sacred_water","horse_hair"].includes(e))):t===E.SAMHAIN&&(s=a.resources.some((e=>["barrow_dust","ogham_sticks"].includes(e)))),s?this.gameStore.addToGameLog(`Your preparations have eased the transition to ${t}.`,!0):(this.addThreatForSeasonalCrossing(),this.gameStore.addToGameLog(`You were unprepared for the transition to ${t}, increasing threat by 2.`,!0))}processEndOfTurn(){this.processThreatEffects();const e=this.gameStore.currentLandscapeId;this.isSacredSite(e)&&this.gameStore.addToGameLog(`You are at a sacred site (${e}). You may perform a ritual to reduce threat.`,!1)}processResourceUse(e){return!!this.isResourceUsefulForThreat(e)&&this.useResourceForThreatReduction(e)}}const Je={SIMPLE:1,COMPLEX:2,ADVANCED:3,LEGENDARY:4},Qe=e=>{if("number"===typeof e)return e;switch(e.toLowerCase()){case"simple":return Je.SIMPLE;case"complex":return Je.COMPLEX;case"advanced":return Je.ADVANCED;case"legendary":return Je.LEGENDARY;default:return Je.SIMPLE}};class Ze{constructor(){(0,Ve.A)(this,"gameStore",S()),(0,Ve.A)(this,"playerStore",A()),(0,Ve.A)(this,"cardStore",T()),(0,Ve.A)(this,"threatService",new Ke)}canCraftItem(e){const t=A(),a=T(),s=S(),n=a.getCraftedItemById(e);if(!n)return{canCraft:!1,missingResources:[],landscapeSupported:!1,playerSkill:!1};if(t.craftedItems.includes(e))return{canCraft:!1,missingResources:[],landscapeSupported:!1,playerSkill:!1};const o=[];for(const l of n.requiredResources)t.resources.includes(l)||o.push(l);const r=this.isComplexitySupportedByLandscape(Qe(n.complexity),s.currentLandscapeId),i=this.playerHasSkillForComplexity(Qe(n.complexity));return{canCraft:0===o.length,missingResources:o,landscapeSupported:r,playerSkill:i}}isComplexitySupportedByLandscape(e,t){const a=T(),s=a.getLandscapeById(t);return!!s&&(!(!s.hasCraftingFacilities&&e>Je.SIMPLE)&&(!!(s.hasCraftingFacilities&&e<=Je.COMPLEX)||(s.specialCraftingCapabilities?e<=s.specialCraftingCapabilities:e===Je.SIMPLE)))}playerHasSkillForComplexity(e){const t=A(),a=t.craftedItemCount;return e===Je.SIMPLE||(e===Je.COMPLEX?a>=1:e===Je.ADVANCED?a>=3:e===Je.LEGENDARY&&a>=5)}craftItem(e){const{canCraft:t,missingResources:a,landscapeSupported:s,playerSkill:n}=this.canCraftItem(e);if(!t)return a.length>0?this.gameStore.addToGameLog(`Cannot craft item: missing resources - ${a.join(", ")}`,!0):s?n?this.gameStore.addToGameLog("Cannot craft item: unknown reason",!0):this.gameStore.addToGameLog("Cannot craft item: insufficient crafting experience",!0):this.gameStore.addToGameLog("Cannot craft item: current landscape does not support this complexity of crafting",!0),!1;const o=this.cardStore.getCraftedItemById(e);if(!o)return this.gameStore.addToGameLog(`Cannot craft item: item with ID ${e} not found`,!0),!1;const r=[];for(const l of o.requiredResources)this.cardStore.getResourceById(l)||r.push(l);if(r.length>0)return this.gameStore.addToGameLog(`Crafting failed: invalid resource references - ${r.join(", ")}`,!0),!1;for(const l of o.requiredResources)this.playerStore.removeResource(l);this.playerStore.addCraftedItem(e),this.playerStore.craftedItems.includes(e)||this.playerStore.uniqueCraftedItemsCount++,o.isLegendary&&(this.playerStore.hasCraftedLegendaryItem=!0);const i=this.threatService.getThreatForCraftedItem(e);return i>0&&(this.threatService.addThreatTokens(i),this.gameStore.addToGameLog(`Crafting this powerful item has increased threat by ${i}.`,!0)),this.gameStore.addToGameLog(`Successfully crafted ${o.name}!`,!0),!0}calculateCraftingDifficulty(e){const t=T(),a=S(),s=t.getCraftedItemById(e);if(!s)return 0;const n=Qe(s.complexity),o="number"===typeof s["difficulty"]?s["difficulty"]:3;let r=o*n;const i=this.getLocationCraftingBonus(e,a.currentLandscapeId);r-=2*i;const l=this.getSeasonalCraftingModifier(a.currentSeason);r+=l;const c=Math.floor(a.threatTokens/3);r+=c;const d=A(),u=Math.floor(d.craftedItemCount/2);return r-=u,Math.max(1,r)}getLocationCraftingBonus(e,t){const a=T(),s=a.getCraftedItemById(e),n=a.getLandscapeById(t);return s&&n?n.hasCraftingFacilities?1:n.craftingBonuses&&s.type&&n.craftingBonuses[s.type]?n.craftingBonuses[s.type]:n.specialCraftingCapabilities&&Qe(s.complexity)<=n.specialCraftingCapabilities?2:0:0}getSeasonalCraftingModifier(e){const t={SAMHAIN:0,WINTERS_DEPTH:1,IMBOLC:0,BELTANE:-1,LUGHNASADH:-1};return t[e]||0}getRecipeSuggestions(){const e=T(),t=e.getAllCraftedItems();return t.filter((e=>e.requiredResources&&e.requiredResources.length>0)).map((e=>e.id))}getRecipeSuggestionsByComplexity(e){const t=T(),a=t.getAllCraftedItems();return a.filter((t=>t.requiredResources&&t.requiredResources.length>0&&t.requiredResources.length<=e)).map((e=>e.id))}getCraftingRequirements(e){const t=T(),a=S(),s=(A(),t.getCraftedItemById(e));if(!s)return null;const{missingResources:n,landscapeSupported:o,playerSkill:r}=this.canCraftItem(e),i=this.calculateCraftingDifficulty(e),l=this.getLocationCraftingBonus(e,a.currentLandscapeId),c=this.getSeasonalCraftingModifier(a.currentSeason);return{item:s,requiredResources:s.requiredResources,missingResources:n,landscapeSupported:o,playerSkill:r,difficulty:i,locationBonus:l,seasonalModifier:c}}applyItemEffect(e){const t=A(),a=T(),s=a.getCraftedItemById(e);if(s&&s.ability&&"object"===typeof s.ability){if("healing"===s.ability.type)t.healHealth(2);else if("protection"===s.ability.type){const t=S();t.addTempEffect(`${e}_protection`,`${s.name} Protection`,s.ability.description||"",2,3)}if(s.drawback){const e=S();e.addThreatTokens(1)}}}checkCraftingVictoryConditions(){const e=A(),t=T(),a=e.craftedItems.some((e=>{const a=t.getCraftedItemById(e);return a&&a.isLegendary}));a&&(e.hasCraftedLegendaryItem=!0);const s=new Set(e.craftedItems.map((e=>{const a=t.getCraftedItemById(e);return a?a.type:null})).filter(Boolean));e.uniqueCraftedItemsCount=s.size}}var et=(0,o.pM)({name:"CraftingStation",setup(){const e=T(),t=A(),a=S(),s=(0,v.KR)(null),n=(0,v.KR)(null);(0,o.sV)((()=>{try{s.value=new Ze,console.log("CraftingStation: CraftingService initialized successfully")}catch(e){console.error("CraftingStation: Error initializing CraftingService:",e)}}));const r=(0,o.EW)((()=>a.currentPhase)),i=(0,o.EW)((()=>t.resources)),l=(0,o.EW)((()=>e.craftedItems.filter((e=>e.requiredResources.every((e=>i.value.includes(e))))))),c=(0,o.EW)((()=>!!n.value&&n.value.requiredResources.every((e=>i.value.includes(e))))),d=t=>{const a=e.getResourceById(t);return a?a.name:"Unknown Resource"},u=e=>i.value.includes(e),h=e=>{n.value=e},p=()=>{if(n.value&&c.value){if(s.value){const e=s.value.craftItem(n.value.id);if(!e)return void console.error("Failed to craft item")}else n.value.requiredResources.forEach((e=>{t.removeResource(e)}));t.addCraftedItem(n.value.id),t.gainExperience(1),a.addToGameLog(`You crafted a ${n.value.name}!`),n.value=null,a.advancePhase()}},m=()=>{n.value=null,a.advancePhase()};return{currentPhase:r,availableRecipes:l,selectedRecipe:n,canCraftSelectedRecipe:c,getResourceName:d,hasResource:u,selectRecipe:h,craftItem:p,cancelCrafting:m,GamePhase:b}}});const tt=(0,c.A)(et,[["render",Xe],["__scopeId","data-v-ccf6e3aa"]]);var at=tt;const st={class:"player-dashboard",style:{border:"2px solid lightblue",position:"relative",height:"50px",display:"flex","align-items":"center"}},nt={class:"player-info"},ot={class:"player-stats",style:{display:"flex",gap:"20px"}},rt={class:"stat"},it={class:"stat-label"},lt={class:"stat-value"},ct={class:"stat"},dt={class:"stat-value"};function ut(e,t,a,s,n,r){return(0,o.uX)(),(0,o.CE)("div",st,[t[1]||(t[1]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"PlayerDashboard",-1)),(0,o.Lk)("div",nt,[(0,o.Lk)("div",ot,[(0,o.Lk)("div",rt,[(0,o.Lk)("span",it,(0,y.v_)(e.character?e.character.name:"Character")+":",1),(0,o.Lk)("span",lt,(0,y.v_)(e.playerStore.health)+"/"+(0,y.v_)(e.playerStore.maxHealth)+" HP",1)]),(0,o.Lk)("div",ct,[t[0]||(t[0]=(0,o.Lk)("span",{class:"stat-label"},"XP:",-1)),(0,o.Lk)("span",dt,(0,y.v_)(e.playerStore.experience),1)])])])])}var ht=(0,o.pM)({name:"PlayerDashboard",setup(){const e=A(),t=T(),a=(0,o.EW)((()=>e.characterId?t.getCharacterById(e.characterId):null));return{playerStore:e,character:a}}});const pt=(0,c.A)(ht,[["render",ut],["__scopeId","data-v-7d10ee33"]]);var mt=pt;const gt={class:"animal-companion-selection"},ft={class:"animal-companion-selection__content"},yt={key:0,class:"empty-state"},vt={key:1,class:"companion-grid"},Ct=["onClick"],Lt={class:"companion-card__header"},Et={class:"season-affinity"},Tt={class:"companion-card__body"},bt={class:"companion-ability"},St={class:"companion-card__footer"},kt=["onClick","disabled"],Rt={key:0,class:"bond-dialog-overlay"},At={class:"bond-dialog"},_t={class:"bond-dialog__header"},It={class:"bond-dialog__content"},wt={class:"resource-list"},Nt=["onClick"],Ot={class:"resource-description"},Gt={class:"bond-dialog__footer"},Mt=["disabled"];function xt(e,t,a,n,r,i){return(0,o.uX)(),(0,o.CE)("div",gt,[t[5]||(t[5]=(0,o.Lk)("h2",{class:"animal-companion-selection__title"},"Available Companions",-1)),(0,o.Lk)("div",ft,[0===e.availableCompanions.length?((0,o.uX)(),(0,o.CE)("div",yt,t[3]||(t[3]=[(0,o.Lk)("p",null,"No animal companions are available in this area.",-1),(0,o.Lk)("p",null,"Continue your journey to find potential companions.",-1)]))):((0,o.uX)(),(0,o.CE)("div",vt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.availableCompanions,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.id,class:"companion-card",onClick:a=>e.selectCompanion(t.id)},[(0,o.Lk)("div",Lt,[(0,o.Lk)("h3",null,(0,y.v_)(t.name),1),(0,o.Lk)("div",Et,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.affinitySeasons,(t=>((0,o.uX)(),(0,o.CE)("span",{key:t,class:(0,y.C4)(["season-tag",t.toLowerCase()])},(0,y.v_)(e.formatSeasonName(t)),3)))),128))])]),(0,o.Lk)("div",Tt,[(0,o.Lk)("p",null,(0,y.v_)(t.description),1),(0,o.Lk)("div",bt,[(0,o.Lk)("h4",null,(0,y.v_)(t.ability.name),1),(0,o.Lk)("p",null,(0,y.v_)(t.ability.description),1)])]),(0,o.Lk)("div",St,[(0,o.Lk)("button",{class:"btn btn--primary",onClick:(0,s.D$)((a=>e.bondWithCompanion(t.id)),["stop"]),disabled:!e.hasCompatibleResources(t.id)}," Bond ",8,kt)])],8,Ct)))),128))]))]),e.showBondDialog?((0,o.uX)(),(0,o.CE)("div",Rt,[(0,o.Lk)("div",At,[(0,o.Lk)("div",_t,[(0,o.Lk)("h3",null,"Bond with "+(0,y.v_)(e.selectedCompanionName),1),(0,o.Lk)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...t)=>e.closeBondDialog&&e.closeBondDialog(...t))},"×")]),(0,o.Lk)("div",It,[t[4]||(t[4]=(0,o.Lk)("p",null,"Select a resource to form a bond:",-1)),(0,o.Lk)("div",wt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.compatibleResources,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.id,class:(0,y.C4)(["resource-item",{selected:e.selectedResource===t.id}]),onClick:a=>e.selectedResource=t.id},[(0,o.Lk)("span",null,(0,y.v_)(t.name),1),(0,o.Lk)("p",Ot,(0,y.v_)(t.description),1)],10,Nt)))),128))])]),(0,o.Lk)("div",Gt,[(0,o.Lk)("button",{class:"btn btn--primary",onClick:t[1]||(t[1]=(...t)=>e.confirmBond&&e.confirmBond(...t)),disabled:!e.selectedResource}," Bond ",8,Mt),(0,o.Lk)("button",{class:"btn btn--secondary",onClick:t[2]||(t[2]=(...t)=>e.closeBondDialog&&e.closeBondDialog(...t))}," Cancel ")])])])):(0,o.Q3)("",!0)])}class Pt{bondWithCompanion(e,t){const a=A(),s=T();if(a.animalCompanions.includes(e))return!1;const n=s.getCompanionById(e);return!!n&&(!!this.isResourceSuitableForBonding(t,e)&&(!!a.removeResource(t)&&(a.addCompanion(e),this.applyBondingEffects(e),!0)))}isResourceSuitableForBonding(e,t){const a=T(),s=a.getResourceById(e),n=a.getCompanionById(t);return!(!s||!n)&&(n.preferredResources&&n.preferredResources.includes(e))}feedCompanion(e,t){const a=A();return!!a.animalCompanions.includes(e)&&(!!this.isResourceSuitableForBonding(t,e)&&(!!a.removeResource(t)&&(this.increaseLoyalty(e),!0)))}getLoyalty(e){const t=A();if(!t.animalCompanions.includes(e))return 0;const a=t.companionLoyalty[e];return a&&"object"===typeof a&&"loyalty"in a?a.loyalty:0}increaseLoyalty(e){const t=A();if(!t.animalCompanions.includes(e))return 0;const a=t.companionLoyalty[e],s=a&&"object"===typeof a&&"loyalty"in a?a.loyalty:0,n=Math.min(s+1,5);return t.setCompanionLoyalty(e,n),this.applyLoyaltyEffects(e,n),n}decreaseLoyalty(e){const t=A();if(!t.animalCompanions.includes(e))return 0;const a=t.companionLoyalty[e],s=a&&"object"===typeof a&&"loyalty"in a?a.loyalty:0,n=Math.max(s-1,0);return t.setCompanionLoyalty(e,n),0===n?(t.removeCompanion(e),-1):(this.applyLoyaltyEffects(e,n),n)}getCompanionsForChallengeType(e){const t=A(),a=T();return t.animalCompanions.filter((t=>{const s=a.getCompanionById(t);return s&&s.challengeBonuses&&s.challengeBonuses[e]>0}))}selectRandomCompanion(){const e=T(),t=A(),a=S(),s=a.currentLandscapeId,n=a.currentSeason;if(!s||!n)return"";const o={sacred_oak_grove:["wolf","deer","bear","boar"],faerie_knoll:["fox","hare"],moonlit_loch:["salmon","owl"],whispering_heath:["raven"],wild_horse_plain:["horse"]};if(!o[s])return"";const r=o[s],i=e.animalCompanions.filter((e=>{if(t.animalCompanions.includes(e.id))return!1;const a=e.id.split("_")[0].toLowerCase();return r.includes(a)}));return i.length>0?i[Math.floor(Math.random()*i.length)].id:""}isCompanionWary(e){const t=A();if(!t.animalCompanions.includes(e))return!1;const a=t.companionLoyalty[e];return a&&"object"===typeof a&&"state"in a&&a.state===m.WARY}applyBondingEffects(e){const t=T(),a=A(),s=t.getCompanionById(e);s&&s.bondingEffect&&s.bondingEffect(a)}applyLoyaltyEffects(e,t){const a=T(),s=A(),n=a.getCompanionById(e);if(!n||!n.loyaltyEffects)return;const o=n.loyaltyEffects[t];o&&o(s)}}const Dt=new Pt;var Ht=(0,o.pM)({name:"AnimalCompanionSelection",emits:["select-companion"],setup(e,{emit:t}){const a=T(),s=A(),n=S(),r=e=>e.replace("_"," ").split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" "),i=(0,o.EW)((()=>{const e=n.currentLandscapeId;if(!e)return[];const t={sacred_oak_grove:["wolf","deer","bear","boar"],faerie_knoll:["fox","hare"],moonlit_loch:["salmon","owl"],whispering_heath:["raven"],wild_horse_plain:["horse"]};if(!t[e])return[];const o=t[e];return a.animalCompanions.filter((e=>{if(s.animalCompanions.includes(e.id))return!1;const t=e.id.split("_")[0].toLowerCase();return o.includes(t)}))})),l=(0,v.KR)(!1),c=(0,v.KR)(""),d=(0,v.KR)("");(0,o.sV)((()=>{const e=Dt.selectRandomCompanion();e&&(c.value=e,p(e)&&g(e))}));const u=(0,o.EW)((()=>{const e=a.getCompanionById(c.value);return e?e.name:""})),h=(0,o.EW)((()=>c.value?s.resources.filter((e=>Dt.isResourceSuitableForBonding(e,c.value))).map((e=>a.getResourceById(e))).filter((e=>void 0!==e)):[])),p=e=>s.resources.some((t=>Dt.isResourceSuitableForBonding(t,e))),m=e=>{t("select-companion",e)},g=e=>{c.value=e;const t=s.resources.filter((t=>Dt.isResourceSuitableForBonding(t,e)));t.length>0?(d.value=t[0],l.value=!0):n.addToGameLog("No compatible resources available for bonding with this companion.")},f=()=>{l.value=!1,d.value=""},y=()=>{if(!c.value||!d.value)return void f();const e=Dt.bondWithCompanion(c.value,d.value);if(e){const e=a.getCompanionById(c.value);n.addToGameLog(`You've bonded with ${e?.name}!`,!0,"companion"),m(c.value)}else n.addToGameLog("Failed to bond with the companion.");f()};return{formatSeasonName:r,availableCompanions:i,showBondDialog:l,selectedCompanion:c,selectedResource:d,selectedCompanionName:u,compatibleResources:h,hasCompatibleResources:p,selectCompanion:m,bondWithCompanion:g,closeBondDialog:f,confirmBond:y}}});const Bt=(0,c.A)(Ht,[["render",xt],["__scopeId","data-v-26ff0409"]]);var Ft=Bt;const $t={class:"companion-management"},Yt={class:"companion-management__content"},Wt={key:0,class:"empty-state"},Ut={key:1,class:"companion-cards"},Xt={class:"available-companions"},jt={key:0,class:"empty-state"},zt={key:1,class:"companion-cards"},qt=["onClick"],Vt={class:"available-companion-card__header"},Kt={class:"available-companion-card__content"},Jt={class:"companion-ability mt-2"},Qt={class:"ability-description"},Zt={class:"companion-seasons mt-2"},ea={class:"season-tags"},ta={class:"available-companion-card__footer"},aa=["onClick","disabled"],sa={key:0,class:"feed-dialog-overlay"},na={class:"feed-dialog"},oa={class:"feed-dialog__header"},ra={class:"feed-dialog__content"},ia={class:"resource-list"},la=["onClick"],ca={class:"feed-dialog__footer"},da=["disabled"];function ua(e,t,a,n,r,i){const l=(0,o.g2)("CompanionCard");return(0,o.uX)(),(0,o.CE)("div",$t,[t[7]||(t[7]=(0,o.Lk)("div",{class:"companion-management__header"},[(0,o.Lk)("h2",{class:"companion-management__title"},"Animal Companions")],-1)),(0,o.Lk)("div",Yt,[0===e.playerCompanions.length?((0,o.uX)(),(0,o.CE)("div",Wt,t[3]||(t[3]=[(0,o.Lk)("p",null,"You haven't bonded with any animal companions yet.",-1),(0,o.Lk)("p",null,"Find a suitable companion and use a resource to form a bond.",-1)]))):((0,o.uX)(),(0,o.CE)("div",Ut,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.playerCompanions,(t=>((0,o.uX)(),(0,o.Wv)(l,{key:t,companionId:t,abilityUsed:e.usedCompanionAbilities.includes(t),canFeed:e.hasCompatibleResources(t),onSelect:e.selectCompanion,onFeed:e.openFeedDialog,onUseAbility:e.useCompanionAbility},null,8,["companionId","abilityUsed","canFeed","onSelect","onFeed","onUseAbility"])))),128))]))]),t[8]||(t[8]=(0,o.Lk)("h3",{class:"mt-4"},"Available Companions",-1)),(0,o.Lk)("div",Xt,[0===e.availableCompanions.length?((0,o.uX)(),(0,o.CE)("div",jt,t[4]||(t[4]=[(0,o.Lk)("p",null,"No companions are available in this area.",-1),(0,o.Lk)("p",null,"Continue exploring to find potential companions.",-1)]))):((0,o.uX)(),(0,o.CE)("div",zt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.availableCompanions,(a=>((0,o.uX)(),(0,o.CE)("div",{key:a.id,class:"available-companion-card",onClick:t=>e.selectAvailableCompanion(a.id)},[(0,o.Lk)("div",Vt,[(0,o.Lk)("h4",null,(0,y.v_)(a.name),1)]),(0,o.Lk)("div",Kt,[(0,o.Lk)("p",null,(0,y.v_)(a.description),1),(0,o.Lk)("div",Jt,[(0,o.Lk)("h5",null,(0,y.v_)(a.ability.name),1),(0,o.Lk)("p",Qt,(0,y.v_)(a.ability.description),1)]),(0,o.Lk)("div",Zt,[t[5]||(t[5]=(0,o.Lk)("h5",null,"Seasonal Affinity",-1)),(0,o.Lk)("div",ea,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.affinitySeasons,(t=>((0,o.uX)(),(0,o.CE)("span",{key:t,class:(0,y.C4)(["season-tag",t.toLowerCase()])},(0,y.v_)(e.formatSeasonName(t)),3)))),128))])])]),(0,o.Lk)("div",ta,[(0,o.Lk)("button",{class:"btn btn--primary",onClick:(0,s.D$)((t=>e.openBondDialog(a.id)),["stop"]),disabled:!e.hasResourcesForBonding(a.id)}," Bond ",8,aa)])],8,qt)))),128))]))]),e.showBondDialog?((0,o.uX)(),(0,o.CE)("div",sa,[(0,o.Lk)("div",na,[(0,o.Lk)("div",oa,[(0,o.Lk)("h3",null,"Bond with "+(0,y.v_)(e.selectedCompanionName),1),(0,o.Lk)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...t)=>e.closeBondDialog&&e.closeBondDialog(...t))},"×")]),(0,o.Lk)("div",ra,[t[6]||(t[6]=(0,o.Lk)("p",null,"Select a resource to form a bond:",-1)),(0,o.Lk)("div",ia,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.compatibleResources,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.id,class:(0,y.C4)(["resource-item",{selected:e.selectedResource===t.id}]),onClick:a=>e.selectedResource=t.id},[(0,o.Lk)("span",null,(0,y.v_)(t.name),1)],10,la)))),128))])]),(0,o.Lk)("div",ca,[(0,o.Lk)("button",{class:"btn btn--primary",onClick:t[1]||(t[1]=(...t)=>e.bondWithCompanion&&e.bondWithCompanion(...t)),disabled:!e.selectedResource}," Bond ",8,da),(0,o.Lk)("button",{class:"btn btn--secondary",onClick:t[2]||(t[2]=(...t)=>e.closeBondDialog&&e.closeBondDialog(...t))}," Cancel ")])])])):(0,o.Q3)("",!0)])}const ha={class:"companion-card__content"},pa={class:"companion-loyalty mt-3"},ma={class:"loyalty-meter"},ga={key:0,class:"companion-ability mt-3"},fa={key:1,class:"companion-seasons mt-3"},ya={class:"season-tags"},va={class:"companion-card__actions"},Ca=["disabled"],La={key:0,class:"feed-dialog-overlay"},Ea={class:"feed-dialog"},Ta={class:"feed-dialog__header"},ba={class:"feed-dialog__content"},Sa={class:"resource-list"},ka=["onClick"],Ra={key:0,class:"empty-state"},Aa={class:"feed-dialog__footer"},_a=["disabled"];function Ia(e,t,a,n,r,i){const l=(0,o.g2)("GameCard");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(l,{title:e.companion?.name||"Unknown Companion",subtitle:"Animal Companion",cardType:e.CardType.ANIMAL_COMPANION,class:(0,y.C4)(["companion-card",{wary:e.isCompanionWary}]),onClick:e.selectCompanion,style:{border:"2px solid lightblue",position:"relative"}},{footer:(0,o.k6)((()=>[(0,o.Lk)("div",va,[e.canFeed?((0,o.uX)(),(0,o.CE)("button",{key:0,class:"btn btn--primary",onClick:t[0]||(t[0]=(0,s.D$)(((...t)=>e.openFeedDialog&&e.openFeedDialog(...t)),["stop"]))}," Feed Companion ")):(0,o.Q3)("",!0),(0,o.Lk)("button",{class:"btn btn--secondary",onClick:t[1]||(t[1]=(0,s.D$)(((...t)=>e.useAbility&&e.useAbility(...t)),["stop"])),disabled:e.abilityUsed||e.isCompanionWary},(0,y.v_)(e.isCompanionWary?"Wary":e.abilityUsed?"Ability Used":"Use Ability"),9,Ca)])])),default:(0,o.k6)((()=>[t[6]||(t[6]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"CompanionCard",-1)),(0,o.Lk)("div",ha,[(0,o.Lk)("p",null,(0,y.v_)(e.companion?.description||"No description available"),1),(0,o.Lk)("div",pa,[(0,o.Lk)("h5",null,"Loyalty Level: "+(0,y.v_)(e.loyalty),1),(0,o.Lk)("div",ma,[(0,o.Lk)("div",{class:"loyalty-bar",style:(0,y.Tr)(e.loyaltyBarStyle)},null,4)])]),e.companion?.ability?((0,o.uX)(),(0,o.CE)("div",ga,[(0,o.Lk)("h5",null,(0,y.v_)(e.companion.ability.name),1),(0,o.Lk)("p",null,(0,y.v_)(e.companion.ability.description),1)])):(0,o.Q3)("",!0),e.companion?.affinitySeasons?((0,o.uX)(),(0,o.CE)("div",fa,[t[5]||(t[5]=(0,o.Lk)("h5",null,"Seasonal Affinity",-1)),(0,o.Lk)("div",ya,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.companion.affinitySeasons,(t=>((0,o.uX)(),(0,o.CE)("span",{key:t,class:(0,y.C4)(["season-tag",t.toLowerCase()])},(0,y.v_)(e.formatSeasonName(t)),3)))),128))])])):(0,o.Q3)("",!0)])])),_:1},8,["title","cardType","class","onClick"]),e.showFeedDialog?((0,o.uX)(),(0,o.CE)("div",La,[(0,o.Lk)("div",Ea,[(0,o.Lk)("div",Ta,[(0,o.Lk)("h3",null,"Feed "+(0,y.v_)(e.companion?.name),1),(0,o.Lk)("button",{class:"close-btn",onClick:t[2]||(t[2]=(...t)=>e.closeFeedDialog&&e.closeFeedDialog(...t))},"×")]),(0,o.Lk)("div",ba,[t[7]||(t[7]=(0,o.Lk)("p",null,"Select a resource to feed your companion:",-1)),(0,o.Lk)("div",Sa,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.compatibleResources,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.id,class:(0,y.C4)(["resource-item",{selected:e.selectedResource===t.id}]),onClick:a=>e.selectedResource=t.id},[(0,o.Lk)("span",null,(0,y.v_)(t.name),1)],10,ka)))),128)),0===e.compatibleResources.length?((0,o.uX)(),(0,o.CE)("div",Ra," No compatible resources available. ")):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",Aa,[(0,o.Lk)("button",{class:"btn btn--primary",onClick:t[3]||(t[3]=(...t)=>e.feedCompanion&&e.feedCompanion(...t)),disabled:!e.selectedResource||0===e.compatibleResources.length}," Feed ",8,_a),(0,o.Lk)("button",{class:"btn btn--secondary",onClick:t[4]||(t[4]=(...t)=>e.closeFeedDialog&&e.closeFeedDialog(...t))}," Cancel ")])])])):(0,o.Q3)("",!0)],64)}var wa=(0,o.pM)({name:"CompanionCard",components:{GameCard:D},props:{companionId:{type:String,required:!0},selected:{type:Boolean,default:!1},abilityUsed:{type:Boolean,default:!1}},emits:["select","use-ability","feed"],setup(e,{emit:t}){const a=T(),s=A(),n=S(),r=(0,v.KR)(!1),i=(0,v.KR)(""),l=(0,o.EW)((()=>a.getCompanionById(e.companionId))),c=(0,o.EW)((()=>Dt.getLoyalty(e.companionId))),d=(0,o.EW)((()=>{const e=c.value/5*100;return{width:`${e}%`,backgroundColor:g(c.value)}})),u=(0,o.EW)((()=>{const t=s.resources;return t.map((e=>a.getResourceById(e))).filter((t=>t&&Dt.isResourceSuitableForBonding(t.id,e.companionId)))})),h=(0,o.EW)((()=>u.value.length>0)),p=(0,o.EW)((()=>Dt.isCompanionWary(e.companionId))),m=e=>e.replace("_"," ").split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" "),g=e=>e<=1?"#FF5252":e<=3?"#FFC107":"#4CAF50",f=()=>{t("select",e.companionId)},y=()=>{r.value=!0,i.value=u.value.length>0?u.value[0].id:""},L=()=>{r.value=!1,i.value=""},E=()=>{if(!i.value)return;const s=Dt.feedCompanion(e.companionId,i.value);if(s){const s=a.getResourceById(i.value);n.addToGameLog(`You fed your ${l.value?.name} with ${s?.name}.`,!0,"companion"),t("feed",e.companionId)}else n.addToGameLog("Failed to feed your companion.");L()},b=()=>{e.abilityUsed||p.value||t("use-ability",e.companionId)};return{companion:l,loyalty:c,loyaltyBarStyle:d,compatibleResources:u,canFeed:h,showFeedDialog:r,selectedResource:i,selectCompanion:f,openFeedDialog:y,closeFeedDialog:L,feedCompanion:E,useAbility:b,formatSeasonName:m,CardType:C,isCompanionWary:p}}});const Na=(0,c.A)(wa,[["render",Ia],["__scopeId","data-v-67224ba0"]]);var Oa=Na,Ga=(0,o.pM)({name:"CompanionManagement",components:{CompanionCard:Oa},emits:["close"],setup(e,{emit:t}){const a=T(),s=A(),n=S(),r=(0,o.EW)((()=>s.animalCompanions)),i=(0,o.EW)((()=>{const e=a.animalCompanions;return e.filter((e=>!r.value.includes(e.id)&&l(e)))})),l=e=>{const t=n.currentSeason;return e.affinitySeasons&&e.affinitySeasons.includes(t)},c=e=>e.replace("_"," ").split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" "),d=(0,v.KR)([]),u=(0,v.KR)(""),h=(0,v.KR)(""),p=(0,v.KR)(!1),m=(0,v.KR)(""),g=e=>s.resources.filter((t=>Dt.isResourceSuitableForBonding(t,e))),f=e=>g(e).length>0,y=e=>s.resources.some((t=>Dt.isResourceSuitableForBonding(t,e))),C=(0,o.EW)((()=>{const e=a.getCompanionById(h.value);return e?e.name:""})),L=(0,o.EW)((()=>h.value?s.resources.filter((e=>Dt.isResourceSuitableForBonding(e,h.value))).map((e=>a.getResourceById(e))).filter((e=>void 0!==e)):[])),E=e=>{u.value=e},b=e=>{h.value=e},k=e=>{h.value=e;const t=g(e);t.length>0?(m.value=t[0],p.value=!0):n.addToGameLog("No compatible resources for bonding with this companion.")},R=()=>{p.value=!1,m.value=""},_=()=>{if(!h.value||!m.value)return void R();const e=Dt.bondWithCompanion(h.value,m.value);if(e){const e=a.getCompanionById(h.value);n.addToGameLog(`You've formed a bond with ${e?.name}!`,!0,"companion")}else n.addToGameLog("Failed to bond with the companion.");R()},I=e=>{if(d.value.includes(e))return;const t=s.useCompanionAbility(e);if(t){d.value.push(e);const t=a.getCompanionById(e);n.addToGameLog(`You used ${t?.name}'s ability: ${t?.ability.name}`,!0,"companion")}else n.addToGameLog("You cannot use this companion's ability right now.")};n.$subscribe(((e,t)=>{t.currentTurn>0&&(d.value=[])}));const w=e=>{console.log(`Open feed dialog for companion ${e}`)},N=()=>{t("close")};return{playerCompanions:r,availableCompanions:i,usedCompanionAbilities:d,selectedCompanion:u,showBondDialog:p,selectedResource:m,selectedCompanionName:C,compatibleResources:L,selectCompanion:E,selectAvailableCompanion:b,openBondDialog:k,closeBondDialog:R,bondWithCompanion:_,useCompanionAbility:I,hasCompatibleResources:f,hasResourcesForBonding:y,formatSeasonName:c,openFeedDialog:w,emitClose:N}}});const Ma=(0,c.A)(Ga,[["render",ua],["__scopeId","data-v-3f0758c0"]]);var xa=Ma;const Pa={class:"game-log",style:{border:"2px solid lightblue",position:"relative"}},Da={class:"game-log__entries",ref:"logContainer"},Ha={key:0,class:"game-log__empty"},Ba={key:1,class:"game-log__paragraph"},Fa={class:"first-letter"},$a={key:0,class:"log-sentence__separator"};function Ya(e,t,a,s,n,r){return(0,o.uX)(),(0,o.CE)("div",Pa,[t[0]||(t[0]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"GameLog",-1)),t[1]||(t[1]=(0,o.Lk)("h3",{class:"game-log__title"},"Journey Log",-1)),(0,o.Lk)("div",Da,[0===e.gameLog.length?((0,o.uX)(),(0,o.CE)("div",Ha," Your journey has just begun. Events will be recorded here. ")):((0,o.uX)(),(0,o.CE)("p",Ba,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.gameLog,((t,a)=>((0,o.uX)(),(0,o.CE)("span",{key:a,class:(0,y.C4)(["log-sentence",{"log-sentence--highlight":t.highlight}])},[(0,o.Lk)("span",Fa,(0,y.v_)(t.message.charAt(0)),1),(0,o.eW)((0,y.v_)(t.message.substring(1))+" ",1),a<e.gameLog.length-1?((0,o.uX)(),(0,o.CE)("span",$a,". ")):(0,o.Q3)("",!0)],2)))),128))]))],512)])}var Wa=(0,o.pM)({name:"GameLog",setup(){const e=S(),t=(0,v.KR)(null),a=(0,o.EW)((()=>e.gameLog)),s=e=>{const t=new Date(e),a=t.getHours().toString().padStart(2,"0"),s=t.getMinutes().toString().padStart(2,"0"),n=t.getSeconds().toString().padStart(2,"0");return`${a}:${s}:${n}`};return(0,o.wB)((()=>a.value.length),(()=>{(0,o.dY)((()=>{t.value&&(t.value.scrollTop=t.value.scrollHeight)}))})),{gameLog:a,logContainer:t,formatTimestamp:s}}});const Ua=(0,c.A)(Wa,[["render",Ya],["__scopeId","data-v-a40774de"]]);var Xa=Ua;const ja={class:"game-board",style:{border:"2px solid lightblue",position:"relative"}},za={class:"game-content"},qa={class:"cards-row-section"},Va={class:"cards-row"},Ka={class:"card-item"},Ja={key:0,class:"card-item"},Qa={key:1,class:"card-item"},Za={class:"phase-content",style:{border:"1px solid #8c7851",position:"relative","margin-top":"0",padding:"5px","background-color":"rgba(240, 230, 210, 0.3)","border-radius":"8px"}},es={key:0,style:{display:"flex","flex-direction":"column","align-items":"center",width:"100%",position:"relative",border:"2px solid lightblue",padding:"5px"}},ts={key:1},as={class:"phase-description"},ss={key:2},ns={class:"challenge-card-container"},os={key:0},rs={key:0},is={key:1},ls={key:2},cs={class:"challenge-details mt-4"},ds={key:3},us={key:4,style:{position:"relative",border:"2px solid lightblue",padding:"10px"}},hs={class:"phase-description"},ps={key:5,style:{position:"relative",border:"2px solid lightblue",padding:"10px"}},ms={class:"resource-actions mt-4"},gs={key:0,class:"resource-warning mt-2"},fs={key:6,style:{position:"relative",border:"2px solid lightblue",padding:"10px"}},ys={key:0},vs={class:"action-buttons mt-4"},Cs={key:1},Ls={key:7,style:{position:"relative",border:"2px solid lightblue",padding:"10px"}},Es={key:8},Ts={class:"journey-actions mt-4"},bs={key:9,style:{position:"relative",border:"2px solid lightblue",padding:"10px"}},Ss={class:"phase-description"},ks={key:0,class:"next-landscape mt-4"},Rs={key:1,class:"mt-4"},As={key:10,style:{position:"relative",border:"2px solid lightblue",padding:"10px"}},_s={class:"phase-description"},Is={class:"landscape-challenges"},ws={style:{display:"flex","margin-top":"5px","font-size":"0.85rem",color:"#666"}},Ns={style:{flex:"1","margin-right":"5px"}},Os={style:{margin:"4px 0"}},Gs={style:{margin:"4px 0"}},Ms={style:{margin:"4px 0"}},xs={style:{margin:"4px 0"}},Ps={style:{flex:"1","margin-left":"5px"}},Ds={style:{margin:"4px 0"}},Hs={style:{margin:"4px 0"}},Bs={style:{margin:"4px 0"}},Fs={style:{margin:"4px 0"}},$s={class:"challenge-actions",style:{"margin-top":"20px",display:"flex",gap:"10px"}},Ys={key:11,style:{position:"relative",border:"2px solid lightblue",padding:"10px"}},Ws={key:12},Us={class:"game-log"};var Xs=(0,o.pM)({__name:"GameBoardView",setup(e){const t=(0,f.rd)(),a=A(),s=S(),n=T(),r=(0,v.KR)(null),i=(0,v.KR)(null),l=(0,v.KR)(null);(0,v.KR)([{id:"SAMHAIN",completed:!1},{id:"WINTERS_DEPTH",completed:!1},{id:"IMBOLC",completed:!1},{id:"BELTANE",completed:!1},{id:"LUGHNASADH",completed:!1}]);(0,o.sV)((()=>{try{l.value=new Ze,console.log("CraftingService initialized successfully")}catch(e){console.error("Error initializing CraftingService:",e)}}));const c=(0,o.EW)((()=>s.currentLandscape)),d=(0,o.EW)((()=>a.characterId?n.characters.find((e=>e.id===a.characterId)):null)),u=(0,o.EW)((()=>s.currentChallenge?n.getChallengeById(s.currentChallenge):null)),h=(0,o.EW)((()=>{const e=T(),t=s.journeyProgress+1;if(t<s.journeyPath.length){const a=s.journeyPath[t];return e.getLandscapeById(a)}return null})),p=e=>{i.value=e},m=()=>{i.value=null},g=((0,o.EW)((()=>!!c.value&&["Sacred Oak Grove","Druid's Sanctuary","Moonlit Loch"].includes(c.value.name))),(0,o.EW)((()=>{if(!a.resources.length)return[];const e=a.getCraftableItems();return e.map((e=>n.getCraftedItemById(e))).filter((e=>void 0!==e))})),(0,o.EW)((()=>{if(!c.value)return null;const e=c.value;return"Iron Forge Dell"===e.name||"Sacred Oak Grove"===e.name||"Druid's Sanctuary"===e.name||"Moonlit Loch"===e.name?1:null})),()=>{if(!u.value||!s.currentChallenge)return void s.addToGameLog("No active challenge to resolve.",!0);console.log("Resolving challenge:",u.value.name);const e=u.value.difficulty||5,t=s.threatLevel,o=0,i=e+t+o;let l=0;d.value?.specialAbility&&(l+=1);const h=a.animalCompanions.length>0?1:0;l+=h;const p=a.craftedItems.length>0?1:0;l+=p;const m=Math.floor(8*Math.random())+1,g=m+l;let f=!1,y=!1,v=0;if(8===m?(f=!0,s.addToGameLog("Natural 8! Automatic success regardless of modifiers.",!0)):(f=g>=i,y=!f&&g===i-1),f){if(r.value={success:!0,message:`You successfully resolved the challenge! Roll: ${m} + ${l} = ${g} vs difficulty ${i}`},s.addToGameLog(`Success! You rolled ${m} + ${l} = ${g} vs difficulty ${i}.`,!0),a.gainExperience(1),s.addToGameLog("You gained 1 experience point!",!0),c.value&&c.value.availableResources&&c.value.availableResources.length>0){let e=0;while(e<2&&!a.isResourceCapacityReached){const t=Math.floor(Math.random()*c.value.availableResources.length),o=c.value.availableResources[t],r=n.getResourceById(o);if(r){const t=a.addResource(o);if(t){const t=n.getResourceById(o);t&&(s.addToGameLog(`You gathered ${t.name}.`,!0),e++)}}else console.error(`Resource with ID ${o} not found in cardStore`),s.addToGameLog("You attempted to gather a resource, but it was unidentifiable.",!0)}}s.setCurrentChallenge(null)}else if(y){if(r.value={success:!1,partialSuccess:!0,message:`You partially resolved the challenge. Roll: ${m} + ${l} = ${g} vs difficulty ${i}`},s.addToGameLog(`Partial success! You rolled ${m} + ${l} = ${g}, just one point below difficulty ${i}.`,!0),Math.random()<.5&&(a.gainExperience(1),s.addToGameLog("You gained 1 experience point for your effort!",!0)),c.value&&c.value.availableResources&&c.value.availableResources.length>0){const e=Math.floor(Math.random()*c.value.availableResources.length),t=c.value.availableResources[e],o=n.getResourceById(t);if(o){const e=a.addResource(t);if(e){const e=n.getResourceById(t);e&&s.addToGameLog(`You gathered ${e.name}.`,!0)}}else console.error(`Resource with ID ${t} not found in cardStore`),s.addToGameLog("You attempted to gather a resource, but it was unidentifiable.",!0)}if(u.value){const e=u.value.type;let t="";switch(e){case L.STRENGTH:case L.AGILITY:v=1,a.loseHealth(v),t=`You suffer a minor injury. You lost ${v} health point.`;break;case L.WISDOM:s.addThreatTokens(1),t="Your confidence wavers. You gained 1 Threat token.";break;case L.DIPLOMACY:if(c.value&&c.value.availableResources&&c.value.availableResources.length>0){const e=Math.floor(Math.random()*c.value.availableResources.length),a=c.value.availableResources[e],o=n.getResourceById(a);o&&(s.addTempEffect(`resource_block_${a}`,"Resource Unavailable",`Cannot gather ${o.name}`,1,1),t=`The local community withholds ${o.name} from you for now.`)}break;case L.SURVIVAL:if(a.animalCompanions.length>0){a.animalCompanions[0];t="Your animal companion becomes wary of this place."}else s.addThreatTokens(1),t="The spiritual imbalance increases. You gained 1 Threat token.";break;default:v=1,a.loseHealth(v),t=`You encounter an unexpected setback. You lost ${v} health point.`}s.addToGameLog(`Setback: ${t}`,!0)}s.setCurrentChallenge(null)}else if(v=1,r.value={success:!1,message:`You failed to resolve the challenge. Roll: ${m} + ${l} = ${g} vs difficulty ${i}`,damage:v},s.addToGameLog(`Failure! You rolled ${m} + ${l} = ${g} vs difficulty ${i}.`,!0),a.loseHealth(v),s.addToGameLog(`You lost ${v} health point${v>1?"s":""}.`,!0),a.health<=0)return s.addToGameLog("Your journey has come to an end...",!0),void P();s.setPhase(b.CHALLENGE_RESOLUTION)}),k=()=>{a.loseHealth(1),s.addToGameLog("You chose to avoid the challenge, losing 1 health in the process.",!0),s.setPhase(b.RESOURCE_MANAGEMENT)},R=()=>{if(!c.value)return 5;const e=c.value.challenges?.[0]?.difficulty||5,t=Math.floor(s.threatTokens/3),a={[E.SAMHAIN]:0,[E.WINTERS_DEPTH]:-2,[E.IMBOLC]:-1,[E.BELTANE]:1,[E.LUGHNASADH]:2},n=a[s.currentSeason]||0;return e+t+n},_=()=>a.equippedItems?.reduce(((e,t)=>e+(t?.challengeBonus||0)),0)||0,I=()=>{const e=a.selectedCharacter?.abilityModifier||0,t=_(),n=s.blessingTokens;return e+t+n},w=()=>{const e={[E.SAMHAIN]:0,[E.WINTERS_DEPTH]:-2,[E.IMBOLC]:-1,[E.BELTANE]:1,[E.LUGHNASADH]:2};return e[s.currentSeason]||0},N=()=>{try{const e=Math.floor(8*Math.random())+1;s.addToGameLog(`You rolled a ${e} on a D8.`,!0);const t=I(),n=e+t,o=R();s.addToGameLog(`You rolled a ${e} + ${t} bonus = ${n} total against difficulty ${o}.`,!0);const i=8===e,l=i||n>=o;i&&s.addToGameLog("A natural 8! Automatic success regardless of difficulty!",!0),r.value={success:l,message:l?"You successfully overcome the landscape challenge!":"You failed to overcome the landscape challenge...",damage:l?0:Math.max(1,Math.floor((o-n)/2))},l||(a.loseHealth(r.value.damage),s.addToGameLog(`You lost ${r.value.damage} health from failing the challenge.`,!0)),s.setPhase(b.CHALLENGE_RESOLUTION)}catch(e){console.error("Error in resolveChallengeLandscape:",e),s.addToGameLog("An error occurred while resolving the challenge.",!0,"error")}},O=()=>{const e=a.resources.length;if(e<2)return void s.addToGameLog("You need at least 2 resources to avoid this challenge!",!0);const t=[];for(let s=0;s<2;s++)if(a.resources.length>0){const e=Math.floor(Math.random()*a.resources.length),s=a.resources.splice(e,1)[0];t.push(s)}const n=t.map((e=>e.name||e.id)).join(" and ");s.addToGameLog(`You spent ${n} to avoid the challenge.`,!0),s.setPhase(b.RESOURCE_MANAGEMENT)},G=()=>{if(!c.value||a.isResourceCapacityReached)return;let e=1;if(s.currentSeason===E.LUGHNASADH&&(e+=1,s.addToGameLog("The harvest season of Lughnasadh allows you to gather an extra resource.")),c.value.availableResources&&c.value.availableResources.length>0){let t=0;while(t<e&&!a.isResourceCapacityReached){const e=Math.floor(Math.random()*c.value.availableResources.length),o=c.value.availableResources[e],r=n.getResourceById(o);if(r){const e=a.addResource(o);if(e){const e=n.getResourceById(o);e&&(s.addToGameLog(`You gathered ${e.name}.`,!0),t++)}}else console.error(`Resource with ID ${o} not found in cardStore`),s.addToGameLog("You attempted to gather a resource, but it was unidentifiable.",!0)}}else s.addToGameLog("There are no resources to gather at this location.",!0);s.advancePhase()},M=()=>{if(s.currentPhase===b.ANIMAL_COMPANION){i.value&&m();const e=T(),t=e.landscapes.filter((e=>!s.visitedLandscapes.includes(e.id)));if(t.length>0){const e=Math.floor(Math.random()*t.length),a=t[e];s.setCurrentLandscape(a.id),s.addVisitedLandscape(a.id)}else s.addToGameLog("You have reached the end of your journey path.",!0),s.completeJourney(!0)}s.advancePhase()},x=()=>{h.value?(s.currentLandscapeId=s.journeyPath[s.journeyProgress+1],s.journeyProgress++,s.addToGameLog(`Arrived at ${h.value.name}.`),s.currentPhase=b.SEASONAL_ASSESSMENT):(s.addToGameLog("You've reached the end of your journey!"),s.journeyComplete=!0,s.advancePhase())},P=()=>{console.log("Ending journey..."),a.resetPlayer(),s.resetGame(),t.push("/menu")},H=e=>{if(!e)return"Unknown";const t=e.toString();return t.charAt(0)+t.slice(1).toLowerCase()},B=e=>{const t=n.getResourceById(e);return t?t.name:"Unknown Resource"},F=e=>{const t=n.getResourceById(e);return t?t.description:"A valuable resource that can be used for crafting and survival."},$=e=>{const t=n.getCraftedItemById(e);return t?t.name:"Unknown Item"},Y=e=>{const t=n.getCraftedItemById(e);return t?t.description:"A crafted item."};return(e,t)=>((0,o.uX)(),(0,o.CE)("div",ja,[(0,o.Lk)("main",za,[(0,o.Lk)("section",qa,[(0,o.Lk)("div",Va,[(0,o.Lk)("div",Ka,[(0,o.bF)(D,{title:H((0,v.R1)(s).currentSeason),subtitle:"Current Season",cardType:(0,v.R1)(C).SEASON},{default:(0,o.k6)((()=>t[11]||(t[11]=[(0,o.Lk)("p",null,"The seasons affect which resources are available and the effectiveness of your animal companions.",-1)]))),_:1},8,["title","cardType"])]),c.value?((0,o.uX)(),(0,o.CE)("div",Ja,[(0,o.bF)(D,{title:c.value.name,subtitle:"Current Landscape",cardType:(0,v.R1)(C).LANDSCAPE},{default:(0,o.k6)((()=>[(0,o.Lk)("p",null,(0,y.v_)(c.value.description),1)])),_:1},8,["title","cardType"])])):(0,o.Q3)("",!0),d.value?((0,o.uX)(),(0,o.CE)("div",Qa,[(0,o.bF)(D,{title:d.value.name,subtitle:"Your Character",cardType:(0,v.R1)(C).CHARACTER},{default:(0,o.k6)((()=>[(0,o.Lk)("p",null,(0,y.v_)(d.value.specialAbility.name)+": "+(0,y.v_)(d.value.specialAbility.description),1)])),_:1},8,["title","cardType"])])):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,v.R1)(a).resources,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e,class:"card-item"},[(0,o.bF)(D,{title:B(e),subtitle:"Resource",cardType:(0,v.R1)(C).RESOURCE},{default:(0,o.k6)((()=>[(0,o.Lk)("p",null,(0,y.v_)(F(e)),1)])),_:2},1032,["title","cardType"])])))),128)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,v.R1)(a).craftedItems,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e,class:"card-item"},[(0,o.bF)(D,{title:$(e),subtitle:"Crafted Item",cardType:(0,v.R1)(C).CRAFTED_ITEM},{default:(0,o.k6)((()=>[(0,o.Lk)("p",null,(0,y.v_)(Y(e)),1)])),_:2},1032,["title","cardType"])])))),128))])]),(0,o.Q3)("",!0),(0,o.Q3)("",!0),(0,o.Lk)("section",Za,[t[67]||(t[67]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"GameBoardView",-1)),t[68]||(t[68]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"115px","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"PhaseContent",-1)),(0,o.bF)(mt),(0,v.R1)(s).currentPhase===(0,v.R1)(b).SEASONAL_ASSESSMENT?((0,o.uX)(),(0,o.CE)("div",es,[t[15]||(t[15]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"SeasonalAssessmentPhase",-1)),(0,o.bF)(D,{title:"Continue Journey",cardType:"ACTION",onClick:t[0]||(t[0]=e=>(0,v.R1)(s).advancePhase())},{default:(0,o.k6)((()=>t[14]||(t[14]=[(0,o.Lk)("div",{style:{"font-size":"1.1rem",padding:"10px"}}," Proceed to the next phase of your adventure ",-1)]))),_:1})])):(0,v.R1)(s).currentPhase===(0,v.R1)(b).EXPLORATION?((0,o.uX)(),(0,o.CE)("div",ts,[t[16]||(t[16]=(0,o.Lk)("h2",{class:"phase-title"},"EXPLORATION",-1)),(0,o.Lk)("div",as,[(0,o.Lk)("p",null,"You are exploring "+(0,y.v_)(c.value?.name)+". What will you discover?",1)]),(0,o.Lk)("button",{onClick:t[1]||(t[1]=e=>(0,v.R1)(s).advancePhase()),style:{"margin-top":"5px","font-weight":"bold",padding:"5px 10px","font-size":"0.9rem","border-radius":"6px",cursor:"pointer",background:"linear-gradient(to bottom, #8c7851, #5a3e2b)",border:"2px solid #f0c8a0",color:"#fff",transition:"all 0.3s ease"}}," Continue to Next Phase ")])):(0,v.R1)(s).currentPhase===(0,v.R1)(b).CHALLENGE&&u.value?((0,o.uX)(),(0,o.CE)("div",ss,[t[19]||(t[19]=(0,o.Lk)("h2",{class:"phase-title"},"CHALLENGE",-1)),(0,o.Lk)("div",ns,[(0,o.bF)(D,{title:u.value.name,subtitle:u.value.description,cardType:(0,v.R1)(C).CHARACTER},{default:(0,o.k6)((()=>[(0,o.Lk)("div",null,[(0,o.Lk)("p",null,[t[17]||(t[17]=(0,o.Lk)("strong",null,"Difficulty:",-1)),(0,o.eW)(" "+(0,y.v_)(u.value.difficulty),1)]),u.value.rewards?((0,o.uX)(),(0,o.CE)("div",os,[t[18]||(t[18]=(0,o.Lk)("h4",null,"Rewards:",-1)),(0,o.Lk)("ul",null,[u.value.rewards.resources?((0,o.uX)(),(0,o.CE)("li",rs,"Resources: "+(0,y.v_)(u.value.rewards.resources.join(", ")),1)):(0,o.Q3)("",!0),u.value.rewards.experience?((0,o.uX)(),(0,o.CE)("li",is,"Experience: "+(0,y.v_)(u.value.rewards.experience),1)):(0,o.Q3)("",!0),u.value.rewards.knowledge?((0,o.uX)(),(0,o.CE)("li",ls,"Knowledge: "+(0,y.v_)(u.value.rewards.knowledge),1)):(0,o.Q3)("",!0)])])):(0,o.Q3)("",!0)])])),_:1},8,["title","subtitle","cardType"])]),(0,o.Lk)("div",cs,[(0,o.Lk)("p",null,"Difficulty: "+(0,y.v_)(R()),1)]),(0,o.Lk)("div",{class:"challenge-actions mt-4"},[(0,o.Lk)("button",{onClick:g,class:"btn btn--primary"}," Face Challenge "),(0,o.Lk)("button",{onClick:k,class:"btn btn--secondary ml-2"}," Avoid (Lose 1 Health) ")])])):(0,v.R1)(s).currentPhase===(0,v.R1)(b).CHALLENGE_RESOLUTION&&r.value?((0,o.uX)(),(0,o.CE)("div",ds,[t[21]||(t[21]=(0,o.Lk)("h2",{class:"phase-title"},"CHALLENGE OUTCOME",-1)),(0,o.Lk)("div",{class:(0,y.C4)(["challenge-result",{success:r.value.success,"partial-success":r.value.partialSuccess,failure:!r.value.success&&!r.value.partialSuccess}])},[(0,o.Lk)("h3",null,(0,y.v_)(r.value.success?"Success!":r.value.partialSuccess?"Partial Success":"Failure"),1),(0,o.Lk)("p",null,(0,y.v_)(r.value.message),1)],2),(0,o.bF)(D,{title:"Continue to Next Phase",cardType:"ACTION",onClick:t[2]||(t[2]=e=>(0,v.R1)(s).advancePhase())},{default:(0,o.k6)((()=>t[20]||(t[20]=[(0,o.Lk)("div",{style:{"font-size":"1rem",padding:"5px"}}," Proceed with your journey ",-1)]))),_:1})])):(0,v.R1)(s).currentPhase===(0,v.R1)(b).THREAT_LEVEL_CHECK?((0,o.uX)(),(0,o.CE)("div",us,[t[25]||(t[25]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"ThreatLevelCheckPhase",-1)),t[26]||(t[26]=(0,o.Lk)("h2",{class:"phase-title"},"THREAT LEVEL CHECK",-1)),(0,o.Lk)("div",hs,[(0,o.Lk)("p",null,[t[22]||(t[22]=(0,o.eW)("The threat level in the Celtic Realm is currently: ")),(0,o.Lk)("strong",null,(0,y.v_)((0,v.R1)(s).threatTokens),1)]),t[23]||(t[23]=(0,o.Lk)("div",null,null,-1))]),(0,o.bF)(D,{title:"Remain Vigilant",cardType:"ACTION",onClick:t[3]||(t[3]=e=>(0,v.R1)(s).advancePhase())},{default:(0,o.k6)((()=>t[24]||(t[24]=[(0,o.Lk)("div",{style:{"font-size":"1.1rem",padding:"10px"}}," Stay alert and advance to the next phase ",-1)]))),_:1})])):(0,v.R1)(s).currentPhase===(0,v.R1)(b).RESOURCE_MANAGEMENT?((0,o.uX)(),(0,o.CE)("div",ps,[t[30]||(t[30]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"ResourceManagementPhase",-1)),t[31]||(t[31]=(0,o.Lk)("h2",{class:"phase-title"},"RESOURCE MANAGEMENT",-1)),(0,o.bF)(Se),(0,o.Lk)("div",ms,[(0,o.bF)(D,{title:"Gather Resources",cardType:"ACTION",onClick:G,class:(0,y.C4)({"disabled-card":(0,v.R1)(a).isResourceCapacityReached}),disabled:(0,v.R1)(a).isResourceCapacityReached},{default:(0,o.k6)((()=>t[27]||(t[27]=[(0,o.Lk)("div",{style:{"font-size":"1rem",padding:"5px"}}," Collect resources from the environment ",-1)]))),_:1},8,["class","disabled"]),(0,o.bF)(D,{title:"Continue Journey",cardType:"ACTION",onClick:(0,v.R1)(s).advancePhase,style:{"margin-left":"8px"}},{default:(0,o.k6)((()=>t[28]||(t[28]=[(0,o.Lk)("div",{style:{"font-size":"1rem",padding:"5px"}}," Move to the next phase ",-1)]))),_:1},8,["onClick"])]),(0,v.R1)(a).isResourceCapacityReached?((0,o.uX)(),(0,o.CE)("div",gs,t[29]||(t[29]=[(0,o.Lk)("p",null,"You've reached your resource capacity!",-1)]))):(0,o.Q3)("",!0)])):(0,v.R1)(s).currentPhase===(0,v.R1)(b).ANIMAL_COMPANION?((0,o.uX)(),(0,o.CE)("div",fs,[t[33]||(t[33]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"AnimalCompanionPhase",-1)),t[34]||(t[34]=(0,o.Lk)("h2",{class:"phase-title"},"ANIMAL COMPANION",-1)),0===(0,v.R1)(a).animalCompanions.length?((0,o.uX)(),(0,o.CE)("div",ys,[(0,o.bF)(Ft,{onSelectCompanion:p}),(0,o.Lk)("div",vs,[(0,o.bF)(D,{title:"Skip Animal Companion",cardType:"ACTION",onClick:M},{default:(0,o.k6)((()=>t[32]||(t[32]=[(0,o.Lk)("div",{style:{"font-size":"1rem",padding:"5px"}}," Continue without a companion ",-1)]))),_:1})])])):((0,o.uX)(),(0,o.CE)("div",Cs,[(0,o.bF)(xa),(0,o.Lk)("div",{class:"action-buttons mt-4"},[(0,o.Lk)("button",{class:"btn btn--primary",onClick:M}," Continue Journey ")])]))])):(0,v.R1)(s).currentPhase===(0,v.R1)(b).CRAFTING?((0,o.uX)(),(0,o.CE)("div",Ls,[t[35]||(t[35]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"CraftingPhase",-1)),t[36]||(t[36]=(0,o.Lk)("h2",{class:"phase-title"},"CRAFTING",-1)),(0,o.bF)(at)])):(0,v.R1)(s).currentPhase===(0,v.R1)(b).JOURNEY?((0,o.uX)(),(0,o.CE)("div",Es,[t[38]||(t[38]=(0,o.Lk)("h2",{class:"phase-title"},"JOURNEY",-1)),(0,o.bF)(re),(0,o.Lk)("div",Ts,[(0,o.bF)(D,{title:"Journey Onwards",cardType:"ACTION",onClick:t[4]||(t[4]=e=>(0,v.R1)(s).advanceJourney(1))},{default:(0,o.k6)((()=>t[37]||(t[37]=[(0,o.Lk)("div",{style:{"font-size":"1rem",padding:"5px"}}," Continue your travels ",-1)]))),_:1})])])):(0,v.R1)(s).currentPhase===(0,v.R1)(b).JOURNEY_PROGRESSION?((0,o.uX)(),(0,o.CE)("div",bs,[t[42]||(t[42]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"JourneyProgressionPhase",-1)),t[43]||(t[43]=(0,o.Lk)("h2",{class:"phase-title"},"JOURNEY PROGRESSION",-1)),(0,o.Lk)("div",Ss,[t[41]||(t[41]=(0,o.Lk)("p",null,"You are ready to journey to the next landscape.",-1)),h.value?((0,o.uX)(),(0,o.CE)("div",ks,[(0,o.bF)(D,{title:h.value.name,subtitle:"Next Landscape",cardType:(0,v.R1)(C).LANDSCAPE,onClick:t[5]||(t[5]=e=>x())},{default:(0,o.k6)((()=>[(0,o.Lk)("p",null,(0,y.v_)(h.value.description),1),t[39]||(t[39]=(0,o.Lk)("div",{class:"action-text",style:{"font-weight":"bold","margin-top":"10px","text-align":"center",color:"#5a3e2b"}}," Click to journey to this location ",-1))])),_:1},8,["title","cardType"])])):((0,o.uX)(),(0,o.CE)("div",Rs,[(0,o.bF)(D,{title:"Continue Journey",cardType:"ACTION",onClick:t[6]||(t[6]=e=>(0,v.R1)(s).advancePhase())},{default:(0,o.k6)((()=>t[40]||(t[40]=[(0,o.Lk)("div",{style:{"font-size":"1.1rem",padding:"10px"}}," Begin the next turn of your adventure ",-1)]))),_:1})]))])])):(0,v.R1)(s).currentPhase===(0,v.R1)(b).LANDSCAPE_CHALLENGE?((0,o.uX)(),(0,o.CE)("div",As,[t[60]||(t[60]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"LandscapeChallengePhase",-1)),t[61]||(t[61]=(0,o.Lk)("h2",{class:"phase-title"},"LANDSCAPE CHALLENGE",-1)),(0,o.Lk)("div",_s,[t[59]||(t[59]=(0,o.Lk)("p",null,"The landscape presents challenges and opportunities. Overcome them to continue your journey.",-1)),(0,o.Lk)("div",Is,[(0,o.Lk)("p",null,[t[44]||(t[44]=(0,o.eW)("Current Landscape: ")),(0,o.Lk)("strong",null,(0,y.v_)(c.value?.name||"Unknown"),1)]),(0,o.Lk)("p",null,[t[45]||(t[45]=(0,o.eW)("Challenge Type: ")),(0,o.Lk)("strong",null,(0,y.v_)(c.value?.challenges?.[0]?.type||"Unknown"),1)]),(0,o.Lk)("div",ws,[(0,o.Lk)("div",Ns,[(0,o.Lk)("p",Os,[t[46]||(t[46]=(0,o.eW)("Base Difficulty: ")),(0,o.Lk)("strong",null,(0,y.v_)(c.value?.challenges?.[0]?.difficulty||4),1)]),(0,o.Lk)("p",Gs,[t[47]||(t[47]=(0,o.eW)("Season Modifier: ")),(0,o.Lk)("strong",null,(0,y.v_)(w()),1)]),(0,o.Lk)("p",Ms,[t[48]||(t[48]=(0,o.eW)("Threat Modifier: ")),(0,o.Lk)("strong",null,"+"+(0,y.v_)(Math.floor((0,v.R1)(s).threatTokens/3)),1)]),(0,o.Lk)("p",xs,[t[49]||(t[49]=(0,o.Lk)("u",null,"Total Difficulty:",-1)),t[50]||(t[50]=(0,o.eW)()),(0,o.Lk)("strong",null,(0,y.v_)(R()),1)])]),(0,o.Lk)("div",Ps,[t[56]||(t[56]=(0,o.Lk)("p",{style:{margin:"4px 0"}},[(0,o.Lk)("u",null,"Your Bonus:")],-1)),(0,o.Lk)("p",Ds,[t[51]||(t[51]=(0,o.eW)("Character Ability: ")),(0,o.Lk)("strong",null,(0,y.v_)((0,v.R1)(a).selectedCharacter?.abilityModifier||0),1)]),(0,o.Lk)("p",Hs,[t[52]||(t[52]=(0,o.eW)("Item Bonuses: ")),(0,o.Lk)("strong",null,(0,y.v_)(_()),1)]),(0,o.Lk)("p",Bs,[t[53]||(t[53]=(0,o.eW)("Blessing Tokens: ")),(0,o.Lk)("strong",null,"+"+(0,y.v_)((0,v.R1)(s).blessingTokens),1)]),(0,o.Lk)("p",Fs,[t[54]||(t[54]=(0,o.Lk)("u",null,"Total Bonus:",-1)),t[55]||(t[55]=(0,o.eW)()),(0,o.Lk)("strong",null,(0,y.v_)(I()),1)])])])]),(0,o.Lk)("div",$s,[(0,o.bF)(D,{title:"Roll D8 and Resolve Challenge",cardType:"ACTION",onClick:t[7]||(t[7]=e=>N())},{default:(0,o.k6)((()=>t[57]||(t[57]=[(0,o.Lk)("div",{style:{"font-size":"1rem",padding:"5px"}}," Test your skills against the challenge ",-1)]))),_:1}),(0,o.bF)(D,{title:"Avoid Challenge",cardType:"ACTION",onClick:t[8]||(t[8]=e=>O())},{default:(0,o.k6)((()=>t[58]||(t[58]=[(0,o.Lk)("div",{style:{"font-size":"1rem",padding:"5px"}}," Cost: 2 Resources ",-1)]))),_:1})])])])):(0,v.R1)(s).currentPhase===(0,v.R1)(b).CHALLENGE_RESOLUTION?((0,o.uX)(),(0,o.CE)("div",Ys,[t[63]||(t[63]=(0,o.Lk)("div",{style:{position:"absolute",top:"-20px",left:"0","background-color":"lightblue",padding:"2px 6px","font-size":"12px",color:"#333","z-index":"1070"}},"ChallengeResolutionPhase",-1)),t[64]||(t[64]=(0,o.Lk)("h2",{class:"phase-title"},"CHALLENGE RESOLUTION",-1)),t[65]||(t[65]=(0,o.Lk)("div",{class:"phase-description"},[(0,o.Lk)("p",null,"Resolve the current challenge with your skills and resources.")],-1)),(0,o.bF)(D,{title:"Continue to Next Phase",cardType:"ACTION",onClick:t[9]||(t[9]=e=>(0,v.R1)(s).advancePhase())},{default:(0,o.k6)((()=>t[62]||(t[62]=[(0,o.Lk)("div",{style:{"font-size":"1rem",padding:"5px"}}," Proceed with your journey ",-1)]))),_:1})])):(0,v.R1)(s).currentPhase===(0,v.R1)(b).SEASONAL_ASSESSMENT?((0,o.uX)(),(0,o.CE)("div",Ws,[(0,o.bF)(D,{title:"Continue Journey",cardType:"ACTION",onClick:t[10]||(t[10]=e=>(0,v.R1)(s).advancePhase())},{default:(0,o.k6)((()=>t[66]||(t[66]=[(0,o.Lk)("div",{style:{"font-size":"1.1rem",padding:"10px"}}," Proceed to the next phase of your adventure ",-1)]))),_:1})])):(0,o.Q3)("",!0)])]),(0,o.Lk)("aside",Us,[(0,o.bF)(Xa)])]))}});const js=(0,c.A)(Xs,[["__scopeId","data-v-774148a1"]]);var zs=js;const qs=[{path:"/",name:"setup",component:K},{path:"/game",name:"game",component:zs}],Vs=(0,f.aE)({history:(0,f.LA)(),routes:qs});var Ks=Vs;const Js=(0,s.Ef)(g);Js.use((0,n.Ey)()),Js.use(Ks),Js.config.errorHandler=(e,t,a)=>{console.error("Global error:",e),console.error("Error info:",a)},Js.mount("#app")}},t={};function a(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,s,n,o){if(!s){var r=1/0;for(d=0;d<e.length;d++){s=e[d][0],n=e[d][1],o=e[d][2];for(var i=!0,l=0;l<s.length;l++)(!1&o||r>=o)&&Object.keys(a.O).every((function(e){return a.O[e](s[l])}))?s.splice(l--,1):(i=!1,o<r&&(r=o));if(i){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[s,n,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,o,r=s[0],i=s[1],l=s[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(n in i)a.o(i,n)&&(a.m[n]=i[n]);if(l)var d=l(a)}for(t&&t(s);c<r.length;c++)o=r[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(d)},s=self["webpackChunkpathfinders_journey"]=self["webpackChunkpathfinders_journey"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],(function(){return a(4835)}));s=a.O(s)})();
//# sourceMappingURL=app.7f18311e.js.map